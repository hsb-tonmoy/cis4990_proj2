var Zr=Object.defineProperty;var Kr=(t,e,n)=>e in t?Zr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var mt=(t,e,n)=>(Kr(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function fe(){}function xn(t){return t()}function nn(){return Object.create(null)}function nt(t){t.forEach(xn)}function Dn(t){return typeof t=="function"}function Bn(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Qr(t){return Object.keys(t).length===0}function G(t,e){t.appendChild(e)}function ge(t,e,n){t.insertBefore(e,n||null)}function ue(t){t.parentNode&&t.parentNode.removeChild(t)}function Y(t){return document.createElement(t)}function rt(t){return document.createTextNode(t)}function ae(){return rt(" ")}function Jr(){return rt("")}function Wn(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function X(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function es(t){return Array.from(t.childNodes)}function Un(t,e){e=""+e,t.data!==e&&(t.data=e)}function wt(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function ts(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}let Pe;function Re(t){Pe=t}function Vn(){if(!Pe)throw new Error("Function called outside component initialization");return Pe}function ns(t){Vn().$$.on_mount.push(t)}function rs(){const t=Vn();return(e,n,{cancelable:r=!1}={})=>{const s=t.$$.callbacks[e];if(s){const o=ts(e,n,{cancelable:r});return s.slice().forEach(i=>{i.call(t,o)}),!o.defaultPrevented}return!0}}const Ae=[],He=[];let Me=[];const _t=[],ss=Promise.resolve();let Et=!1;function os(){Et||(Et=!0,ss.then(Fn))}function Ct(t){Me.push(t)}function rn(t){_t.push(t)}const gt=new Set;let Ce=0;function Fn(){if(Ce!==0)return;const t=Pe;do{try{for(;Ce<Ae.length;){const e=Ae[Ce];Ce++,Re(e),is(e.$$)}}catch(e){throw Ae.length=0,Ce=0,e}for(Re(null),Ae.length=0,Ce=0;He.length;)He.pop()();for(let e=0;e<Me.length;e+=1){const n=Me[e];gt.has(n)||(gt.add(n),n())}Me.length=0}while(Ae.length);for(;_t.length;)_t.pop()();Et=!1,gt.clear(),Re(t)}function is(t){if(t.fragment!==null){t.update(),nt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ct)}}function as(t){const e=[],n=[];Me.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Me=e}const Ge=new Set;let cs;function jn(t,e){t&&t.i&&(Ge.delete(t),t.i(e))}function ls(t,e,n,r){if(t&&t.o){if(Ge.has(t))return;Ge.add(t),cs.c.push(()=>{Ge.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function sn(t,e,n){const r=t.$$.props[e];r!==void 0&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function us(t){t&&t.c()}function qn(t,e,n){const{fragment:r,after_update:s}=t.$$;r&&r.m(e,n),Ct(()=>{const o=t.$$.on_mount.map(xn).filter(Dn);t.$$.on_destroy?t.$$.on_destroy.push(...o):nt(o),t.$$.on_mount=[]}),s.forEach(Ct)}function $n(t,e){const n=t.$$;n.fragment!==null&&(as(n.after_update),nt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ds(t,e){t.$$.dirty[0]===-1&&(Ae.push(t),os(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Gn(t,e,n,r,s,o,i=null,a=[-1]){const c=Pe;Re(t);const l=t.$$={fragment:null,ctx:[],props:o,update:fe,not_equal:s,bound:nn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:nn(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};i&&i(l.root);let u=!1;if(l.ctx=n?n(t,e.props||{},(d,m,...y)=>{const f=y.length?y[0]:m;return l.ctx&&s(l.ctx[d],l.ctx[d]=f)&&(!l.skip_bound&&l.bound[d]&&l.bound[d](f),u&&ds(t,d)),m}):[],l.update(),u=!0,nt(l.before_update),l.fragment=r?r(l.ctx):!1,e.target){if(e.hydrate){const d=es(e.target);l.fragment&&l.fragment.l(d),d.forEach(ue)}else l.fragment&&l.fragment.c();e.intro&&jn(t.$$.fragment),qn(t,e.target,e.anchor),Fn()}Re(c)}class zn{constructor(){mt(this,"$$");mt(this,"$$set")}$destroy(){$n(this,1),this.$destroy=fe}$on(e,n){if(!Dn(n))return fe;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!Qr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const hs="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(hs);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function H(t,e,n,r){return new(n||(n=Promise))(function(s,o){function i(l){try{c(r.next(l))}catch(u){o(u)}}function a(l){try{c(r.throw(l))}catch(u){o(u)}}function c(l){var u;l.done?s(l.value):(u=l.value,u instanceof n?u:new n(function(d){d(u)})).then(i,a)}c((r=r.apply(t,e||[])).next())})}class De{constructor(){this.listeners={}}on(e,n,r){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(n),r==null?void 0:r.once){const s=()=>{this.un(e,s),this.un(e,n)};return this.on(e,s),s}return()=>this.un(e,n)}un(e,n){var r;(r=this.listeners[e])===null||r===void 0||r.delete(n)}once(e,n){return this.on(e,n,{once:!0})}unAll(){this.listeners={}}emit(e,...n){this.listeners[e]&&this.listeners[e].forEach(r=>r(...n))}}const on={decode:function(t,e){return H(this,void 0,void 0,function*(){const n=new AudioContext({sampleRate:e});return n.decodeAudioData(t).finally(()=>n.close())})},createBuffer:function(t,e){return typeof t[0]=="number"&&(t=[t]),function(n){const r=n[0];if(r.some(s=>s>1||s<-1)){const s=r.length;let o=0;for(let i=0;i<s;i++){const a=Math.abs(r[i]);a>o&&(o=a)}for(const i of n)for(let a=0;a<s;a++)i[a]/=o}}(t),{duration:e,length:t[0].length,sampleRate:t[0].length/e,numberOfChannels:t.length,getChannelData:n=>t==null?void 0:t[n],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function Hn(t,e){const n=e.xmlns?document.createElementNS(e.xmlns,t):document.createElement(t);for(const[r,s]of Object.entries(e))if(r==="children")for(const[o,i]of Object.entries(e))typeof i=="string"?n.appendChild(document.createTextNode(i)):n.appendChild(Hn(o,i));else r==="style"?Object.assign(n.style,s):r==="textContent"?n.textContent=s:n.setAttribute(r,s.toString());return n}function an(t,e,n){const r=Hn(t,e||{});return n==null||n.appendChild(r),r}var fs=Object.freeze({__proto__:null,createElement:an,default:an});const ps={fetchBlob:function(t,e,n){return H(this,void 0,void 0,function*(){const r=yield fetch(t,n);if(r.status>=400)throw new Error(`Failed to fetch ${t}: ${r.status} (${r.statusText})`);return function(s,o){H(this,void 0,void 0,function*(){if(!s.body||!s.headers)return;const i=s.body.getReader(),a=Number(s.headers.get("Content-Length"))||0;let c=0;const l=d=>H(this,void 0,void 0,function*(){c+=(d==null?void 0:d.length)||0;const m=Math.round(c/a*100);o(m)}),u=()=>H(this,void 0,void 0,function*(){let d;try{d=yield i.read()}catch{return}d.done||(l(d.value),yield u())});u()})}(r.clone(),e),r.blob()})}};class ms extends De{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}onMediaEvent(e,n,r){return this.media.addEventListener(e,n,r),()=>this.media.removeEventListener(e,n,r)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,n){if(this.getSrc()===e)return;this.revokeSrc();const r=n instanceof Blob&&this.canPlayType(n.type)?URL.createObjectURL(n):e;this.media.src=r}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return H(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=e}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,n){n!=null&&(this.media.preservesPitch=n),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}class st extends De{constructor(e,n){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.options=e;const r=this.parentFromOptionsContainer(e.container);this.parent=r;const[s,o]=this.initHtml();r.appendChild(s),this.container=s,this.scrollContainer=o.querySelector(".scroll"),this.wrapper=o.querySelector(".wrapper"),this.canvasWrapper=o.querySelector(".canvases"),this.progressWrapper=o.querySelector(".progress"),this.cursor=o.querySelector(".cursor"),n&&o.appendChild(n),this.initEvents()}parentFromOptionsContainer(e){let n;if(typeof e=="string"?n=document.querySelector(e):e instanceof HTMLElement&&(n=e),!n)throw new Error("Container not found");return n}initEvents(){const e=r=>{const s=this.wrapper.getBoundingClientRect(),o=r.clientX-s.left,i=r.clientX-s.left;return[o/s.width,i/s.height]};this.wrapper.addEventListener("click",r=>{const[s,o]=e(r);this.emit("click",s,o)}),this.wrapper.addEventListener("dblclick",r=>{const[s,o]=e(r);this.emit("dblclick",s,o)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:r,scrollWidth:s,clientWidth:o}=this.scrollContainer,i=r/s,a=(r+o)/s;this.emit("scroll",i,a)});const n=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{n().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){(function(e,n,r,s,o=3,i=0,a=100){if(!e)return()=>{};let c,l=!1,u=!1,d=0,m=0,y=0;const f=matchMedia("(pointer: coarse)").matches,h=g=>{g.button===i&&(g.stopPropagation(),l=!0,u=!1,y=Date.now(),c=e.getBoundingClientRect(),d=g.clientX-c.left,m=g.clientY-c.top)},v=g=>{if(l=!1,y=0,u){g.preventDefault(),g.stopPropagation(),setTimeout(()=>{u=!1},300);const _=g.clientX-c.left,b=g.clientY-c.top;s==null||s(_,b)}},p=g=>{if(!l||f&&Date.now()-y<a)return;g.preventDefault(),g.stopPropagation();const _=g.clientX-c.left,b=g.clientY-c.top,E=_-d,M=b-m;(u||Math.abs(E)>o||Math.abs(M)>o)&&(u||(r==null||r(d,m),u=!0),n(E,M,_,b),d=_,m=b)},C=g=>{g.relatedTarget&&g.relatedTarget!==document.documentElement||v(g)},w=g=>{u&&g.preventDefault()},A=g=>{u&&(g.stopPropagation(),g.preventDefault())};e.addEventListener("pointerdown",h),e.addEventListener("click",A,!0),document.addEventListener("click",A,!0),document.addEventListener("pointermove",p),document.addEventListener("touchmove",w,{passive:!1}),document.addEventListener("pointerup",v),document.addEventListener("pointerleave",C),document.addEventListener("pointercancel",v)})(this.wrapper,(e,n,r)=>{this.emit("drag",Math.max(0,Math.min(1,r/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))})}getHeight(e){return e==null?128:isNaN(Number(e))?e==="auto"&&this.parent.clientHeight||128:Number(e)}initHtml(){const e=document.createElement("div"),n=e.attachShadow({mode:"open"});return n.innerHTML=`
      <style>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,n]}setOptions(e){if(this.options.container!==e.container){const n=this.parentFromOptionsContainer(e.container);n.appendChild(this.container),this.parent=n}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:n}=this.scrollContainer,r=n*e;this.setScroll(r)}destroy(){var e;this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect()}createDelay(e=10){let n,r;const s=()=>{n&&clearTimeout(n),r&&r()};return this.timeouts.push(s),()=>new Promise((o,i)=>{s(),r=i,n=setTimeout(()=>{n=void 0,r=void 0,o()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";const n=document.createElement("canvas"),r=n.getContext("2d"),s=n.height*(window.devicePixelRatio||1),o=r.createLinearGradient(0,0,0,s),i=1/(e.length-1);return e.forEach((a,c)=>{const l=c*i;o.addColorStop(l,a)}),o}renderBarWaveform(e,n,r,s){const o=e[0],i=e[1]||e[0],a=o.length,{width:c,height:l}=r.canvas,u=l/2,d=window.devicePixelRatio||1,m=n.barWidth?n.barWidth*d:1,y=n.barGap?n.barGap*d:n.barWidth?m/2:0,f=n.barRadius||0,h=c/(m+y)/a,v=f&&"roundRect"in r?"roundRect":"rect";r.beginPath();let p=0,C=0,w=0;for(let A=0;A<=a;A++){const g=Math.round(A*h);if(g>p){const E=Math.round(C*u*s),M=E+Math.round(w*u*s)||1;let S=u-E;n.barAlign==="top"?S=0:n.barAlign==="bottom"&&(S=l-M),r[v](p*(m+y),S,m,M,f),p=g,C=0,w=0}const _=Math.abs(o[A]||0),b=Math.abs(i[A]||0);_>C&&(C=_),b>w&&(w=b)}r.fill(),r.closePath()}renderLineWaveform(e,n,r,s){const o=i=>{const a=e[i]||e[0],c=a.length,{height:l}=r.canvas,u=l/2,d=r.canvas.width/c;r.moveTo(0,u);let m=0,y=0;for(let f=0;f<=c;f++){const h=Math.round(f*d);if(h>m){const p=u+(Math.round(y*u*s)||1)*(i===0?-1:1);r.lineTo(m,p),m=h,y=0}const v=Math.abs(a[f]||0);v>y&&(y=v)}r.lineTo(m,u)};r.beginPath(),o(0),o(1),r.fill(),r.closePath()}renderWaveform(e,n,r){if(r.fillStyle=this.convertColorValues(n.waveColor),n.renderFunction)return void n.renderFunction(e,r);let s=n.barHeight||1;if(n.normalize){const o=Array.from(e[0]).reduce((i,a)=>Math.max(i,Math.abs(a)),0);s=o?1/o:1}n.barWidth||n.barGap||n.barAlign?this.renderBarWaveform(e,n,r,s):this.renderLineWaveform(e,n,r,s)}renderSingleCanvas(e,n,r,s,o,i,a,c){const l=window.devicePixelRatio||1,u=document.createElement("canvas"),d=e[0].length;u.width=Math.round(r*(i-o)/d),u.height=s*l,u.style.width=`${Math.floor(u.width/l)}px`,u.style.height=`${s}px`,u.style.left=`${Math.floor(o*r/l/d)}px`,a.appendChild(u);const m=u.getContext("2d");if(this.renderWaveform(e.map(y=>y.slice(o,i)),n,m),u.width>0&&u.height>0){const y=u.cloneNode(),f=y.getContext("2d");f.drawImage(u,0,0),f.globalCompositeOperation="source-in",f.fillStyle=this.convertColorValues(n.progressColor),f.fillRect(0,0,u.width,u.height),c.appendChild(y)}}renderChannel(e,n,r,s){var{overlay:o}=n,i=function(a,c){var l={};for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&c.indexOf(u)<0&&(l[u]=a[u]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var d=0;for(u=Object.getOwnPropertySymbols(a);d<u.length;d++)c.indexOf(u[d])<0&&Object.prototype.propertyIsEnumerable.call(a,u[d])&&(l[u[d]]=a[u[d]])}return l}(n,["overlay"]);return H(this,void 0,void 0,function*(){const a=document.createElement("div"),c=this.getHeight(i.height);a.style.height=`${c}px`,o&&s>0&&(a.style.marginTop=`-${c}px`),this.canvasWrapper.style.minHeight=`${c}px`,this.canvasWrapper.appendChild(a);const l=a.cloneNode();this.progressWrapper.appendChild(l);const u=e[0].length,d=(A,g)=>{this.renderSingleCanvas(e,i,r,c,Math.max(0,A),Math.min(g,u),a,l)};if(!this.isScrollable)return void d(0,u);const{scrollLeft:m,scrollWidth:y,clientWidth:f}=this.scrollContainer,h=u/y;let v=Math.min(st.MAX_CANVAS_WIDTH,f);if(i.barWidth||i.barGap){const A=i.barWidth||.5,g=A+(i.barGap||A/2);v%g!=0&&(v=Math.floor(v/g)*g)}const p=Math.floor(Math.abs(m)*h),C=Math.floor(p+v*h),w=C-p;w<=0||(d(p,C),yield Promise.all([H(this,void 0,void 0,function*(){if(p===0)return;const A=this.createDelay();for(let g=p;g>=0;g-=w)yield A(),d(Math.max(0,g-w),g)}),H(this,void 0,void 0,function*(){if(C===u)return;const A=this.createDelay();for(let g=C;g<u;g+=w)yield A(),d(g,Math.min(u,g+w))})]))})}render(e){return H(this,void 0,void 0,function*(){this.timeouts.forEach(a=>a()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const n=window.devicePixelRatio||1,r=this.scrollContainer.clientWidth,s=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=s>r;const o=this.options.fillParent&&!this.isScrollable,i=(o?r:s)*n;this.wrapper.style.width=o?"100%":`${s}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render");try{if(this.options.splitChannels)yield Promise.all(Array.from({length:e.numberOfChannels}).map((a,c)=>{var l;const u=Object.assign(Object.assign({},this.options),(l=this.options.splitChannels)===null||l===void 0?void 0:l[c]);return this.renderChannel([e.getChannelData(c)],u,i,c)}));else{const a=[e.getChannelData(0)];e.numberOfChannels>1&&a.push(e.getChannelData(1)),yield this.renderChannel(a,this.options,i,0)}}catch{return}this.emit("rendered")})}reRender(){if(!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:n}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:r}=this.progressWrapper.getBoundingClientRect();let s=r-n;s*=2,s=s<0?Math.floor(s):Math.ceil(s),s/=2,this.scrollContainer.scrollLeft+=s}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,n=!1){const{scrollLeft:r,scrollWidth:s,clientWidth:o}=this.scrollContainer,i=e*s,a=r,c=r+o,l=o/2;if(this.isDragging)i+30>c?this.scrollContainer.scrollLeft+=30:i-30<a&&(this.scrollContainer.scrollLeft-=30);else{(i<a||i>c)&&(this.scrollContainer.scrollLeft=i-(this.options.autoCenter?l:0));const u=i-r-l;n&&this.options.autoCenter&&u>0&&(this.scrollContainer.scrollLeft+=Math.min(u,10))}{const u=this.scrollContainer.scrollLeft,d=u/s,m=(u+o)/s;this.emit("scroll",d,m)}}renderProgress(e,n){if(isNaN(e))return;const r=100*e;this.canvasWrapper.style.clipPath=`polygon(${r}% 0, 100% 0, 100% 100%, ${r}% 100%)`,this.progressWrapper.style.width=`${r}%`,this.cursor.style.left=`${r}%`,this.cursor.style.transform=`translateX(-${Math.round(r)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,n)}exportImage(e,n,r){return H(this,void 0,void 0,function*(){const s=this.canvasWrapper.querySelectorAll("canvas");if(!s.length)throw new Error("No waveform data");if(r==="dataURL"){const o=Array.from(s).map(i=>i.toDataURL(e,n));return Promise.resolve(o)}return Promise.all(Array.from(s).map(o=>new Promise((i,a)=>{o.toBlob(c=>{c?i(c):a(new Error("Could not export image"))},e,n)})))})}}st.MAX_CANVAS_WIDTH=4e3;class gs extends De{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class cn extends De{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return H(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(n=>{if(n.status>=400)throw new Error(`Failed to fetch ${e}: ${n.status} (${n.statusText})`);return n.arrayBuffer()}).then(n=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(n)).then(n=>{this.currentSrc===e&&(this.buffer=n,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var e;if(!this.paused)return;this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let n=this.playedDuration*this._playbackRate;n>=this.duration&&(n=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,n),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return H(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){var n,r;const s=e-this.currentTime;(n=this.bufferNode)===null||n===void 0||n.stop(this.audioContext.currentTime+s),(r=this.bufferNode)===null||r===void 0||r.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(e){return H(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const n=!this.paused;n&&this._pause(),this.playedDuration=e/this._playbackRate,n&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,n;return(e=this._duration)!==null&&e!==void 0?e:((n=this.buffer)===null||n===void 0?void 0:n.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const n=this.buffer.numberOfChannels;for(let r=0;r<n;r++)e.push(this.buffer.getChannelData(r));return e}}const vs={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class Le extends ms{static create(e){return new Le(e)}constructor(e){const n=e.media||(e.backend==="WebAudio"?new cn:void 0);super({media:n,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.abortController=new AbortController,this.options=Object.assign({},vs,e),this.timer=new gs;const r=n?void 0:this.getMediaElement();this.renderer=new st(this.options,r),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins(),Promise.resolve().then(()=>{this.emit("init");const s=this.options.url||this.getSrc()||"";(s||this.options.peaks&&this.options.duration)&&this.load(s,this.options.peaks,this.options.duration).catch(()=>null)})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",e=>{this.emit("error",e.error)}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,n)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,n))}),this.renderer.on("dblclick",(e,n)=>{this.emit("dblclick",e,n)}),this.renderer.on("scroll",(e,n)=>{const r=this.getDuration();this.emit("scroll",e*r,n*r)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}));{let e;this.subscriptions.push(this.renderer.on("drag",n=>{if(!this.options.interact)return;let r;this.renderer.renderProgress(n),clearTimeout(e),this.isPlaying()?r=0:this.options.dragToSeek===!0?r=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(r=this.options.dragToSeek.debounceTime),e=setTimeout(()=>{this.seekTo(n)},r),this.emit("interaction",n*this.getDuration()),this.emit("drag",n)}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(n=>{this.registerPlugin(n)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e._init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(n=>n!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getScroll(){return this.renderer.getScroll()}setScrollTime(e){const n=e/this.getDuration();this.renderer.setScrollPercentage(n)}getActivePlugins(){return this.plugins}loadAudio(e,n,r,s){var o;return H(this,void 0,void 0,function*(){if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!n&&!r){const a=l=>this.emit("loading",l),c=Object.assign({signal:(o=this.abortController)===null||o===void 0?void 0:o.signal},this.options.fetchParams||{});n=yield ps.fetchBlob(e,a,c)}this.setSrc(e,n);const i=s||this.getDuration()||(yield new Promise(a=>{this.onMediaEvent("loadedmetadata",()=>a(this.getDuration()),{once:!0})}));if(!e&&!n){const a=this.getMediaElement();a instanceof cn&&(a.duration=i)}if(r)this.decodedData=on.createBuffer(r,i||0);else if(n){const a=yield n.arrayBuffer();this.decodedData=yield on.decode(a,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,n,r){return H(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,n,r)}catch(s){throw this.emit("error",s),s}})}loadBlob(e,n,r){return H(this,void 0,void 0,function*(){try{return yield this.loadAudio("blob",e,n,r)}catch(s){throw this.emit("error",s),s}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:n=8e3,precision:r=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const s=Math.min(e,this.decodedData.numberOfChannels),o=[];for(let i=0;i<s;i++){const a=this.decodedData.getChannelData(i),c=[],l=Math.round(a.length/n);for(let u=0;u<n;u++){const d=a.slice(u*l,(u+1)*l);let m=0;for(let y=0;y<d.length;y++){const f=d[y];Math.abs(f)>Math.abs(m)&&(m=f)}c.push(Math.round(m*r)/r)}o.push(c)}return o}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const n=this.getDuration()*e;this.setTime(n)}playPause(){return H(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(e="image/png",n=1,r="dataURL"){return H(this,void 0,void 0,function*(){return this.renderer.exportImage(e,n,r)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(n=>n.destroy()),this.subscriptions.forEach(n=>n()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}Le.BasePlugin=class extends De{constructor(t){super(),this.subscriptions=[],this.options=t}onInit(){}_init(t){this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(t=>t())}},Le.dom=fs;const ln=""+new URL("mic-HR1ivggp.png",import.meta.url).href,At=""+new URL("stop-BDP2NVE4.png",import.meta.url).href,ys=t=>e=>{const n=t(e);return e.add(n),n},bs=t=>(e,n)=>(t.set(e,n),n),un=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,Xn=536870912,dn=Xn*2,ws=(t,e)=>n=>{const r=e.get(n);let s=r===void 0?n.size:r<dn?r+1:0;if(!n.has(s))return t(n,s);if(n.size<Xn){for(;n.has(s);)s=Math.floor(Math.random()*dn);return t(n,s)}if(n.size>un)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;n.has(s);)s=Math.floor(Math.random()*un);return t(n,s)},Yn=new WeakMap,_s=bs(Yn),Dt=ws(_s,Yn),Es=ys(Dt),Cs=t=>typeof t.start=="function",hn=new WeakMap,As=t=>({...t,connect:({call:e})=>async()=>{const{port1:n,port2:r}=new MessageChannel,s=await e("connect",{port:n},[n]);return hn.set(r,s),r},disconnect:({call:e})=>async n=>{const r=hn.get(n);if(r===void 0)throw new Error("The given port is not connected.");await e("disconnect",{portId:r})},isSupported:({call:e})=>()=>e("isSupported")}),vt=new WeakMap,Ts=t=>{if(vt.has(t))return vt.get(t);const e=new Map;return vt.set(t,e),e},Zn=t=>{const e=As(t);return n=>{const r=Ts(n);n.addEventListener("message",({data:a})=>{const{id:c}=a;if(c!==null&&r.has(c)){const{reject:l,resolve:u}=r.get(c);r.delete(c),a.error===void 0?u(a.result):l(new Error(a.error.message))}}),Cs(n)&&n.start();const s=(a,c=null,l=[])=>new Promise((u,d)=>{const m=Dt(r);r.set(m,{reject:d,resolve:u}),c===null?n.postMessage({id:m,method:a},l):n.postMessage({id:m,method:a,params:c},l)}),o=(a,c,l=[])=>{n.postMessage({id:null,method:a,params:c},l)};let i={};for(const[a,c]of Object.entries(e))i={...i,[a]:c({call:s,notify:o})};return{...i}}},fn=new Set,Ms=Zn({encode:({call:t})=>async(e,n)=>{const r=await t("encode",{encoderId:e,timeslice:n});return fn.delete(e),r},instantiate:({call:t})=>async(e,n)=>{const r=Es(fn),s=await t("instantiate",{encoderId:r,mimeType:e,sampleRate:n});return{encoderId:r,port:s}},register:({call:t})=>e=>t("register",{port:e},[e])}),ks=t=>{const e=new Worker(t);return Ms(e)},Ns=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),c=void 0===a?r.size:a<s?a+1:0;if(!r.has(c))return e(r,c);if(r.size<o){for(;r.has(c);)c=Math.floor(Math.random()*s);return e(r,c)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(c);)c=Math.floor(Math.random()*n);return e(r,c)}},c=new WeakMap,i=r(c),l=a(i,c),u=t(l);e.addUniqueNumber=u,e.generateUniqueNumber=l}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async a=>{let{data:{id:c,method:i,params:l}}=a;const u=r[i];try{if(void 0===u)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===l?u():u(l);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const a=r instanceof Promise?await r:r;if(null===c){if(void 0!==a.result)throw s(i)}else{if(void 0===a.result)throw s(i);const{result:e,transferables:r=[]}=a;t.postMessage({id:c,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:c})}};var c=r(455);const i=new Map,l=(e,r,n)=>({...r,connect:t=>{let{port:n}=t;n.start();const o=e(n,r),s=(0,c.generateUniqueNumber)(i);return i.set(s,(()=>{o(),n.close(),i.delete(s)})),{result:s}},disconnect:e=>{let{portId:r}=e;const n=i.get(r);if(void 0===n)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(r);return n(),{result:null}},isSupported:async()=>{if(await new Promise((e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=t=>{let{data:r}=t;return e(null!==r)},n.postMessage(t,[t])}))){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),u=function(e,t){const r=l(u,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0),n=a(e,r);return e.addEventListener("message",n),()=>e.removeEventListener("message",n)},d=e=>{e.onmessage=null,e.close()},h=new WeakMap,f=new WeakMap,p=(e=>{const t=(r=e,{...r,connect:e=>{let{call:t}=e;return async()=>{const{port1:e,port2:r}=new MessageChannel,n=await t("connect",{port:e},[e]);return h.set(r,n),r}},disconnect:e=>{let{call:t}=e;return async e=>{const r=h.get(e);if(void 0===r)throw new Error("The given port is not connected.");await t("disconnect",{portId:r})}},isSupported:e=>{let{call:t}=e;return()=>t("isSupported")}});var r;return e=>{const r=(e=>{if(f.has(e))return f.get(e);const t=new Map;return f.set(e,t),t})(e);e.addEventListener("message",(e=>{let{data:t}=e;const{id:n}=t;if(null!==n&&r.has(n)){const{reject:e,resolve:o}=r.get(n);r.delete(n),void 0===t.error?o(t.result):e(new Error(t.error.message))}})),(e=>"function"==typeof e.start)(e)&&e.start();const n=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return new Promise(((s,a)=>{const i=(0,c.generateUniqueNumber)(r);r.set(i,{reject:a,resolve:s}),null===n?e.postMessage({id:i,method:t},o):e.postMessage({id:i,method:t,params:n},o)}))},o=function(t,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e.postMessage({id:null,method:t,params:r},n)};let s={};for(const[e,r]of Object.entries(t))s={...s,[e]:r({call:n,notify:o})};return{...s}}})({characterize:e=>{let{call:t}=e;return()=>t("characterize")},encode:e=>{let{call:t}=e;return(e,r)=>t("encode",{recordingId:e,timeslice:r})},record:e=>{let{call:t}=e;return async(e,r,n)=>{await t("record",{recordingId:e,sampleRate:r,typedArrays:n},n.map((e=>{let{buffer:t}=e;return t})))}}}),w=async(e,t)=>{const r=p(t),n=await r.characterize(),o=n.toString();if(e.has(o))throw new Error("There is already an encoder stored which handles exactly the same mime types.");return e.set(o,[n,r]),n},m=new Map,g=(e=>t=>{const r=e.get(t);if(void 0===r)throw new Error("There was no instance of an encoder stored with the given id.");return r})(m),v=((e,t)=>r=>{const n=t(r);return e.delete(r),n})(m,g),y=new Map,M=((e,t)=>r=>{const[n,o,s,a]=t(r);return s?new Promise((t=>{o.onmessage=s=>{let{data:c}=s;0===c.length?(e(o),t(n.encode(r,null))):n.record(r,a,c)}})):n.encode(r,null)})(d,v),E=(e=>t=>{for(const[r,n]of Array.from(e.values()))if(r.test(t))return n;throw new Error("There is no encoder registered which could handle the given mimeType.")})(y),b=((e,t,r)=>(n,o,s)=>{if(t.has(n))throw new Error('There is already an encoder registered with an id called "'.concat(n,'".'));const a=r(o),{port1:c,port2:i}=new MessageChannel,l=[a,c,!0,s];return t.set(n,l),c.onmessage=t=>{let{data:r}=t;0===r.length?(e(c),l[2]=!1):a.record(n,s,r.map((e=>"number"==typeof e?new Float32Array(e):e)))},i})(d,m,E),T=(e=>(t,r)=>{const[n]=e(t);return n.encode(t,r)})(g);u(self,{encode:async e=>{let{encoderId:t,timeslice:r}=e;const n=null===r?await M(t):await T(t,r);return{result:n,transferables:n}},instantiate:e=>{let{encoderId:t,mimeType:r,sampleRate:n}=e;const o=b(t,r,n);return{result:o,transferables:[o]}},register:async e=>{let{port:t}=e;return{result:await w(y,t)}}})})()})();`,Ss=new Blob([Ns],{type:"application/javascript; charset=utf-8"}),Kn=URL.createObjectURL(Ss),Bt=ks(Kn),Xe=Bt.encode,Qn=Bt.instantiate,Os=Bt.register;URL.revokeObjectURL(Kn);const Rs=t=>(e,n)=>{if(t===null)throw new Error("A native BlobEvent could not be created.");return new t(e,n)},Ps=(t,e)=>(n,r,s)=>{const o=[];let i=r,a=0;for(;a<n.byteLength;)if(i===null){const c=e(n,a);if(c===null)break;const{length:l,type:u}=c;i=u,a+=l}else{const c=t(n,a,i,s);if(c===null)break;const{content:l,length:u}=c;i=null,a+=u,l!==null&&o.push(l)}return{contents:o,currentElementType:i,offset:a}},Ls=(t,e)=>class{constructor(r=null){this._listeners=new WeakMap,this._nativeEventTarget=r===null?t():r}addEventListener(r,s,o){if(s!==null){let i=this._listeners.get(s);i===void 0&&(i=e(this,s),typeof s=="function"&&this._listeners.set(s,i)),this._nativeEventTarget.addEventListener(r,i,o)}}dispatchEvent(r){return this._nativeEventTarget.dispatchEvent(r)}removeEventListener(r,s,o){const i=s===null?void 0:this._listeners.get(s);this._nativeEventTarget.removeEventListener(r,i===void 0?null:i,o)}},Is=t=>()=>{if(t===null)throw new Error("A native EventTarget could not be created.");return t.document.createElement("p")},xs=(t="")=>{try{return new DOMException(t,"InvalidModificationError")}catch(e){return e.code=13,e.message=t,e.name="InvalidModificationError",e}},Ds=()=>{try{return new DOMException("","InvalidStateError")}catch(t){return t.code=11,t.name="InvalidStateError",t}},Bs=(t,e,n,r,s,o,i)=>class extends o{constructor(c,l={}){const{mimeType:u}=l;if(i!==null&&(u===void 0||i.isTypeSupported!==void 0&&i.isTypeSupported(u))){const d=t(i,c,l);super(d),this._internalMediaRecorder=d}else if(u!==void 0&&s.some(d=>d.test(u)))super(),i!==null&&i.isTypeSupported!==void 0&&i.isTypeSupported("audio/webm;codecs=pcm")?this._internalMediaRecorder=r(this,i,c,u):this._internalMediaRecorder=n(this,c,u);else throw i!==null&&t(i,c,l),e();this._ondataavailable=null,this._onerror=null,this._onpause=null,this._onresume=null,this._onstart=null,this._onstop=null}get mimeType(){return this._internalMediaRecorder.mimeType}get ondataavailable(){return this._ondataavailable===null?this._ondataavailable:this._ondataavailable[0]}set ondataavailable(c){if(this._ondataavailable!==null&&this.removeEventListener("dataavailable",this._ondataavailable[1]),typeof c=="function"){const l=c.bind(this);this.addEventListener("dataavailable",l),this._ondataavailable=[c,l]}else this._ondataavailable=null}get onerror(){return this._onerror===null?this._onerror:this._onerror[0]}set onerror(c){if(this._onerror!==null&&this.removeEventListener("error",this._onerror[1]),typeof c=="function"){const l=c.bind(this);this.addEventListener("error",l),this._onerror=[c,l]}else this._onerror=null}get onpause(){return this._onpause===null?this._onpause:this._onpause[0]}set onpause(c){if(this._onpause!==null&&this.removeEventListener("pause",this._onpause[1]),typeof c=="function"){const l=c.bind(this);this.addEventListener("pause",l),this._onpause=[c,l]}else this._onpause=null}get onresume(){return this._onresume===null?this._onresume:this._onresume[0]}set onresume(c){if(this._onresume!==null&&this.removeEventListener("resume",this._onresume[1]),typeof c=="function"){const l=c.bind(this);this.addEventListener("resume",l),this._onresume=[c,l]}else this._onresume=null}get onstart(){return this._onstart===null?this._onstart:this._onstart[0]}set onstart(c){if(this._onstart!==null&&this.removeEventListener("start",this._onstart[1]),typeof c=="function"){const l=c.bind(this);this.addEventListener("start",l),this._onstart=[c,l]}else this._onstart=null}get onstop(){return this._onstop===null?this._onstop:this._onstop[0]}set onstop(c){if(this._onstop!==null&&this.removeEventListener("stop",this._onstop[1]),typeof c=="function"){const l=c.bind(this);this.addEventListener("stop",l),this._onstop=[c,l]}else this._onstop=null}get state(){return this._internalMediaRecorder.state}pause(){return this._internalMediaRecorder.pause()}resume(){return this._internalMediaRecorder.resume()}start(c){return this._internalMediaRecorder.start(c)}stop(){return this._internalMediaRecorder.stop()}static isTypeSupported(c){return i!==null&&i.isTypeSupported!==void 0&&i.isTypeSupported(c)||s.some(l=>l.test(c))}},Ws=t=>t!==null&&t.BlobEvent!==void 0?t.BlobEvent:null,Us=t=>t===null||t.MediaRecorder===void 0?null:t.MediaRecorder,Vs=t=>(e,n,r)=>{const s=new Map,o=new WeakMap,i=new WeakMap,a=[],c=new e(n,r),l=new WeakMap;return c.addEventListener("stop",({isTrusted:u})=>{u&&setTimeout(()=>a.shift())}),c.addEventListener=(u=>(d,m,y)=>{let f=m;if(typeof m=="function")if(d==="dataavailable"){const h=[];f=v=>{const[[p,C]=[!1,!1]]=a;p&&!C?h.push(v):m.call(c,v)},s.set(m,h),o.set(m,f)}else d==="error"?(f=h=>{h instanceof ErrorEvent?m.call(c,h):m.call(c,new ErrorEvent("error",{error:h.error}))},i.set(m,f)):d==="stop"&&(f=h=>{for(const[v,p]of s.entries())if(p.length>0){const[C]=p;p.length>1&&Object.defineProperty(C,"data",{value:new Blob(p.map(({data:w})=>w),{type:C.data.type})}),p.length=0,v.call(c,C)}m.call(c,h)},l.set(m,f));return u.call(c,d,f,y)})(c.addEventListener),c.removeEventListener=(u=>(d,m,y)=>{let f=m;if(typeof m=="function"){if(d==="dataavailable"){s.delete(m);const h=o.get(m);h!==void 0&&(f=h)}else if(d==="error"){const h=i.get(m);h!==void 0&&(f=h)}else if(d==="stop"){const h=l.get(m);h!==void 0&&(f=h)}}return u.call(c,d,f,y)})(c.removeEventListener),c.start=(u=>d=>{if(r.mimeType!==void 0&&r.mimeType.startsWith("audio/")&&n.getVideoTracks().length>0)throw t();return c.state==="inactive"&&a.push([d!==void 0,!0]),d===void 0?u.call(c):u.call(c,d)})(c.start),c.stop=(u=>()=>{c.state!=="inactive"&&(a[0][1]=!1),u.call(c)})(c.stop),c},Tt=()=>{try{return new DOMException("","NotSupportedError")}catch(t){return t.code=9,t.name="NotSupportedError",t}},Fs=t=>(e,n,r,s=2)=>{const o=t(e,n);if(o===null)return o;const{length:i,value:a}=o;if(r==="master")return{content:null,length:i};if(n+i+a>e.byteLength)return null;if(r==="binary"){const c=(a/Float32Array.BYTES_PER_ELEMENT-1)/s,l=Array.from({length:s},()=>new Float32Array(c));for(let u=0;u<c;u+=1){const d=u*s+1;for(let m=0;m<s;m+=1)l[m][u]=e.getFloat32(n+i+(d+m)*Float32Array.BYTES_PER_ELEMENT,!0)}return{content:l,length:i+a}}return{content:null,length:i+a}},js=t=>(e,n)=>{const r=t(e,n);if(r===null)return r;const{length:s,value:o}=r;return o===35?{length:s,type:"binary"}:o===46||o===97||o===88713574||o===106212971||o===139690087||o===172351395||o===256095861?{length:s,type:"master"}:{length:s,type:"unknown"}},qs=t=>(e,n)=>{const r=t(e,n);if(r===null)return r;const s=n+Math.floor((r-1)/8);if(s+r>e.byteLength)return null;let i=e.getUint8(s)&(1<<8-r%8)-1;for(let a=1;a<r;a+=1)i=(i<<8)+e.getUint8(s+a);return{length:r,value:i}},pn=Symbol.observable||"@@observable";function $s(t){return Symbol.observable||(typeof t=="function"&&t.prototype&&t.prototype[Symbol.observable]?(t.prototype[pn]=t.prototype[Symbol.observable],delete t.prototype[Symbol.observable]):(t[pn]=t[Symbol.observable],delete t[Symbol.observable])),t}const je=()=>{},mn=t=>{throw t};function Gs(t){return t?t.next&&t.error&&t.complete?t:{complete:(t.complete??je).bind(t),error:(t.error??mn).bind(t),next:(t.next??je).bind(t)}:{complete:je,error:mn,next:je}}const zs=t=>(e,n,r)=>t(s=>{const o=i=>s.next(i);return e.addEventListener(n,o,r),()=>e.removeEventListener(n,o,r)}),Hs=(t,e)=>{const n=()=>{},r=s=>typeof s[0]=="function";return s=>{const o=(...i)=>{const a=s(r(i)?e({next:i[0]}):e(...i));return a!==void 0?a:n};return o[Symbol.observable]=()=>({subscribe:(...i)=>({unsubscribe:o(...i)})}),t(o)}},Xs=Hs($s,Gs),Jn=zs(Xs),Ys=(t,e,n)=>async r=>{const s=new t([n],{type:"application/javascript; charset=utf-8"}),o=e.createObjectURL(s);try{await r(o)}finally{e.revokeObjectURL(o)}},Zs=t=>({data:e})=>{const{id:n}=e;if(n!==null){const r=t.get(n);if(r!==void 0){const{reject:s,resolve:o}=r;t.delete(n),e.error===void 0?o(e.result):s(new Error(e.error.message))}}},Ks=t=>(e,n)=>(r,s=[])=>new Promise((o,i)=>{const a=t(e);e.set(a,{reject:i,resolve:o}),n.postMessage({id:a,...r},s)}),Qs=(t,e,n,r)=>(s,o,i={})=>{const a=new s(o,"recorder-audio-worklet-processor",{...i,channelCountMode:"explicit",numberOfInputs:1,numberOfOutputs:0}),c=new Map,l=e(c,a.port),u=n(a.port,"message")(t(c));a.port.start();let d="inactive";return Object.defineProperties(a,{pause:{get(){return async()=>(r(["recording"],d),d="paused",l({method:"pause"}))}},port:{get(){throw new Error("The port of a RecorderAudioWorkletNode can't be accessed.")}},record:{get(){return async m=>(r(["inactive"],d),d="recording",l({method:"record",params:{encoderPort:m}},[m]))}},resume:{get(){return async()=>(r(["paused"],d),d="recording",l({method:"resume"}))}},stop:{get(){return async()=>{r(["paused","recording"],d),d="stopped";try{await l({method:"stop"})}finally{u()}}}}}),a},Js=(t,e)=>{if(!t.includes(e))throw new Error(`Expected the state to be ${t.map(n=>`"${n}"`).join(" or ")} but it was "${e}".`)},eo='(()=>{"use strict";class e extends AudioWorkletProcessor{constructor(){super(),this._encoderPort=null,this._numberOfChannels=0,this._state="inactive",this.port.onmessage=e=>{let{data:t}=e;"pause"===t.method?"active"===this._state||"recording"===this._state?(this._state="paused",this._sendAcknowledgement(t.id)):this._sendUnexpectedStateError(t.id):"record"===t.method?"inactive"===this._state?(this._encoderPort=t.params.encoderPort,this._state="active",this._sendAcknowledgement(t.id)):this._sendUnexpectedStateError(t.id):"resume"===t.method?"paused"===this._state?(this._state="active",this._sendAcknowledgement(t.id)):this._sendUnexpectedStateError(t.id):"stop"===t.method?"active"!==this._state&&"paused"!==this._state&&"recording"!==this._state||null===this._encoderPort?this._sendUnexpectedStateError(t.id):(this._stop(this._encoderPort),this._sendAcknowledgement(t.id)):"number"==typeof t.id&&this.port.postMessage({error:{code:-32601,message:"The requested method is not supported."},id:t.id})}}process(e){let[t]=e;if("inactive"===this._state||"paused"===this._state)return!0;if("active"===this._state){if(void 0===t)throw new Error("No channelData was received for the first input.");if(0===t.length)return!0;this._state="recording"}if("recording"===this._state&&null!==this._encoderPort){if(void 0===t)throw new Error("No channelData was received for the first input.");return 0===t.length?this._encoderPort.postMessage(Array.from({length:this._numberOfChannels},(()=>128))):(this._encoderPort.postMessage(t,t.map((e=>{let{buffer:t}=e;return t}))),this._numberOfChannels=t.length),!0}return!1}_sendAcknowledgement(e){this.port.postMessage({id:e,result:null})}_sendUnexpectedStateError(e){this.port.postMessage({error:{code:-32603,message:"The internal state does not allow to process the given message."},id:e})}_stop(e){e.postMessage([]),e.close(),this._encoderPort=null,this._state="stopped"}}e.parameterDescriptors=[],registerProcessor("recorder-audio-worklet-processor",e)})();',to=Ys(Blob,URL,eo),no=Qs(Zs,Ks(Dt),Jn,Js),gn=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),vn=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),Mt=(t,e)=>({startTime:e,type:"setValue",value:t}),er=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),tr=(t,e,{startTime:n,target:r,timeConstant:s})=>r+(e-r)*Math.exp((n-t)/s),Te=t=>t.type==="exponentialRampToValue",Ye=t=>t.type==="linearRampToValue",ce=t=>Te(t)||Ye(t),Wt=t=>t.type==="setValue",re=t=>t.type==="setValueCurve",Ze=(t,e,n,r)=>{const s=t[e];return s===void 0?r:ce(s)||Wt(s)?s.value:re(s)?s.values[s.values.length-1]:tr(n,Ze(t,e-1,s.startTime,r),s)},yn=(t,e,n,r,s)=>n===void 0?[r.insertTime,s]:ce(n)?[n.endTime,n.value]:Wt(n)?[n.startTime,n.value]:re(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,Ze(t,e-1,n.startTime,s)],kt=t=>t.type==="cancelAndHold",Nt=t=>t.type==="cancelScheduledValues",ie=t=>kt(t)||Nt(t)?t.cancelTime:Te(t)||Ye(t)?t.endTime:t.startTime,bn=(t,e,n,{endTime:r,value:s})=>n===s?s:0<n&&0<s||n<0&&s<0?n*(s/n)**((t-e)/(r-e)):0,wn=(t,e,n,{endTime:r,value:s})=>n+(t-e)/(r-e)*(s-n),ro=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},so=(t,{duration:e,startTime:n,values:r})=>{const s=(t-n)/e*(r.length-1);return ro(r,s)},qe=t=>t.type==="setTarget";class oo{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=ie(e);if(kt(e)||Nt(e)){const r=this._automationEvents.findIndex(o=>Nt(e)&&re(o)?o.startTime+o.duration>=n:ie(o)>=n),s=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),kt(e)){const o=this._automationEvents[this._automationEvents.length-1];if(s!==void 0&&ce(s)){if(o!==void 0&&qe(o))throw new Error("The internal list is malformed.");const i=o===void 0?s.insertTime:re(o)?o.startTime+o.duration:ie(o),a=o===void 0?this._defaultValue:re(o)?o.values[o.values.length-1]:o.value,c=Te(s)?bn(n,i,a,s):wn(n,i,a,s),l=Te(s)?gn(c,n,this._currenTime):vn(c,n,this._currenTime);this._automationEvents.push(l)}if(o!==void 0&&qe(o)&&this._automationEvents.push(Mt(this.getValue(n),n)),o!==void 0&&re(o)&&o.startTime+o.duration>n){const i=n-o.startTime,a=(o.values.length-1)/o.duration,c=Math.max(2,1+Math.ceil(i*a)),l=i/(c-1)*a,u=o.values.slice(0,c);if(l<1)for(let d=1;d<c;d+=1){const m=l*d%1;u[d]=o.values[d-1]*(1-m)+o.values[d]*m}this._automationEvents[this._automationEvents.length-1]=er(u,o.startTime,i)}}}else{const r=this._automationEvents.findIndex(i=>ie(i)>n),s=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(s!==void 0&&re(s)&&ie(s)+s.duration>n)return!1;const o=Te(e)?gn(e.value,e.endTime,this._currenTime):Ye(e)?vn(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(o);else{if(re(e)&&n+e.duration>ie(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,o)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>ie(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),s=r[0];qe(s)&&r.unshift(Mt(Ze(this._automationEvents,n-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(i=>ie(i)>e),r=this._automationEvents[n],s=(n===-1?this._automationEvents.length:n)-1,o=this._automationEvents[s];if(o!==void 0&&qe(o)&&(r===void 0||!ce(r)||r.insertTime>e))return tr(e,Ze(this._automationEvents,s-1,o.startTime,this._defaultValue),o);if(o!==void 0&&Wt(o)&&(r===void 0||!ce(r)))return o.value;if(o!==void 0&&re(o)&&(r===void 0||!ce(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?so(e,o):o.values[o.values.length-1];if(o!==void 0&&ce(o)&&(r===void 0||!ce(r)))return o.value;if(r!==void 0&&Te(r)){const[i,a]=yn(this._automationEvents,s,o,r,this._defaultValue);return bn(e,i,a,r)}if(r!==void 0&&Ye(r)){const[i,a]=yn(this._automationEvents,s,o,r,this._defaultValue);return wn(e,i,a,r)}return this._defaultValue}}const io=t=>({cancelTime:t,type:"cancelAndHold"}),ao=t=>({cancelTime:t,type:"cancelScheduledValues"}),co=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),lo=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),uo=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),ho=()=>new DOMException("","AbortError"),fo=t=>(e,n,[r,s,o],i)=>{t(e[s],[n,r,o],a=>a[0]===n&&a[1]===r,i)},po=t=>(e,n,r)=>{const s=[];for(let o=0;o<r.numberOfInputs;o+=1)s.push(new Set);t.set(e,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},mo=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},ke=new WeakSet,nr=new WeakMap,rr=new WeakMap,sr=new WeakMap,or=new WeakMap,ir=new WeakMap,ar=new WeakMap,St=new WeakMap,Ot=new WeakMap,Rt=new WeakMap,cr={construct(){return cr}},go=t=>{try{const e=new Proxy(t,cr);new e}catch{return!1}return!0},_n=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,En=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),s=r.match(_n);for(;s!==null;){const o=s[1].slice(1,-1),i=s[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());n.push(i),r=r.slice(s[0].length).replace(/^[\s]+/,""),s=r.match(_n)}return[n.join(";"),r]},Cn=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},An=t=>{if(!go(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},vo=(t,e,n,r,s,o,i,a,c,l,u,d,m)=>{let y=0;return(f,h,v={credentials:"omit"})=>{const p=u.get(f);if(p!==void 0&&p.has(h))return Promise.resolve();const C=l.get(f);if(C!==void 0){const g=C.get(h);if(g!==void 0)return g}const w=o(f),A=w.audioWorklet===void 0?s(h).then(([g,_])=>{const[b,E]=En(g,_),M=`${b};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${E}
})})(window,'_AWGS')`;return n(M)}).then(()=>{const g=m._AWGS.pop();if(g===void 0)throw new SyntaxError;r(w.currentTime,w.sampleRate,()=>g(class{},void 0,(_,b)=>{if(_.trim()==="")throw e();const E=Ot.get(w);if(E!==void 0){if(E.has(_))throw e();An(b),Cn(b.parameterDescriptors),E.set(_,b)}else An(b),Cn(b.parameterDescriptors),Ot.set(w,new Map([[_,b]]))},w.sampleRate,void 0,void 0))}):Promise.all([s(h),Promise.resolve(t(d,d))]).then(([[g,_],b])=>{const E=y+1;y=E;const[M,S]=En(g,_),x=`${M};((AudioWorkletProcessor,registerProcessor)=>{${S}
})(${b?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${b?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${b?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${E}',class extends AudioWorkletProcessor{process(){return !1}})`,B=new Blob([x],{type:"application/javascript; charset=utf-8"}),R=URL.createObjectURL(B);return w.audioWorklet.addModule(R,v).then(()=>{if(a(w))return w;const D=i(w);return D.audioWorklet.addModule(R,v).then(()=>D)}).then(D=>{if(c===null)throw new SyntaxError;try{new c(D,`__sac${E}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(R))});return C===void 0?l.set(f,new Map([[h,A]])):C.set(h,A),A.then(()=>{const g=u.get(f);g===void 0?u.set(f,new Set([h])):g.add(h)}).finally(()=>{const g=l.get(f);g!==void 0&&g.delete(h)}),A}},te=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},ot=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},lr=(t,e,n,r)=>{const s=te(t,e),o=ot(s,i=>i[0]===n&&i[1]===r);return s.size===0&&t.delete(e),o},Be=t=>te(ar,t),Ke=t=>{if(ke.has(t))throw new Error("The AudioNode is already stored.");ke.add(t),Be(t).forEach(e=>e(!0))},ur=t=>"port"in t,Ut=t=>{if(!ke.has(t))throw new Error("The AudioNode is not stored.");ke.delete(t),Be(t).forEach(e=>e(!1))},Pt=(t,e)=>{!ur(t)&&e.every(n=>n.size===0)&&Ut(t)},yo=(t,e,n,r,s,o,i,a,c,l,u,d,m)=>{const y=new WeakMap;return(f,h,v,p,C)=>{const{activeInputs:w,passiveInputs:A}=o(h),{outputs:g}=o(f),_=a(f),b=E=>{const M=c(h),S=c(f);if(E){const k=lr(A,f,v,p);t(w,f,k,!1),!C&&!d(f)&&n(S,M,v,p),m(h)&&Ke(h)}else{const k=r(w,f,v,p);e(A,p,k,!1),!C&&!d(f)&&s(S,M,v,p);const L=i(h);if(L===0)u(h)&&Pt(h,w);else{const I=y.get(h);I!==void 0&&clearTimeout(I),y.set(h,setTimeout(()=>{u(h)&&Pt(h,w)},L*1e3))}}};return l(g,[h,v,p],E=>E[0]===h&&E[1]===v&&E[2]===p,!0)?(_.add(b),u(f)?t(w,f,[v,p,b],!0):e(A,p,[f,v,b],!0),!0):!1}},bo=t=>(e,n,[r,s,o],i)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[s,n,o]])):t(a,[s,n,o],c=>c[0]===s&&c[1]===n,i)},wo=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const s=()=>{n.removeEventListener("ended",s),n.disconnect(r),r.disconnect()};n.addEventListener("ended",s)},_o=t=>(e,n)=>{t(e).add(n)},dr=(t,e)=>t.context===e,Tn=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},ve=()=>new DOMException("","IndexSizeError"),Eo=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?ve():r}})(t.getChannelData)},Co={numberOfChannels:1},Ao=(t,e,n,r,s,o,i,a)=>{let c=null;return class hr{constructor(u){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:d,numberOfChannels:m,sampleRate:y}={...Co,...u};c===null&&(c=new s(1,1,44100));const f=r!==null&&e(o,o)?new r({length:d,numberOfChannels:m,sampleRate:y}):c.createBuffer(m,d,y);if(f.numberOfChannels===0)throw n();return typeof f.copyFromChannel!="function"?(i(f),Eo(f)):e(Tn,()=>Tn(f))||a(f),t.add(f),f}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===hr.prototype||t.has(u)}}},it=-34028234663852886e22,Vt=-it,he=t=>ke.has(t),To={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Mo=(t,e,n,r,s,o,i,a)=>class extends t{constructor(l,u){const d=o(l),m={...To,...u},y=s(d,m),f=i(d),h=f?e():null;super(l,!1,y,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=m.buffer!==null,this._nativeAudioBufferSourceNode=y,this._onended=null,this._playbackRate=n(this,f,y.playbackRate,Vt,it)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const d=this._nativeAudioBufferSourceNode.onended;this._onended=d!==null&&d===u?l:d}get playbackRate(){return this._playbackRate}start(l=0,u=0,d){if(this._nativeAudioBufferSourceNode.start(l,u,d),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=d===void 0?[l,u]:[l,u,d]),this.context.state!=="closed"){Ke(this);const m=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",m),he(this)&&Ut(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",m)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},ko=(t,e,n,r,s)=>()=>{const o=new WeakMap;let i=null,a=null;const c=async(l,u)=>{let d=n(l);const m=dr(d,u);if(!m){const y={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=e(u,y),i!==null&&d.start(...i),a!==null&&d.stop(a)}return o.set(u,d),m?await t(u,l.playbackRate,d.playbackRate):await r(u,l.playbackRate,d.playbackRate),await s(l,u,d),d};return{set start(l){i=l},set stop(l){a=l},render(l,u){const d=o.get(u);return d!==void 0?Promise.resolve(d):c(l,u)}}},No=t=>"playbackRate"in t,So=t=>"frequency"in t&&"gain"in t,Oo=t=>"offset"in t,Ro=t=>!("frequency"in t)&&"gain"in t,Po=t=>"detune"in t&&"frequency"in t,Lo=t=>"pan"in t,Z=t=>te(nr,t),We=t=>te(sr,t),Lt=(t,e)=>{const{activeInputs:n}=Z(t);n.forEach(s=>s.forEach(([o])=>{e.includes(t)||Lt(o,[...e,t])}));const r=No(t)?[t.playbackRate]:ur(t)?Array.from(t.parameters.values()):So(t)?[t.Q,t.detune,t.frequency,t.gain]:Oo(t)?[t.offset]:Ro(t)?[t.gain]:Po(t)?[t.detune,t.frequency]:Lo(t)?[t.pan]:[];for(const s of r){const o=We(s);o!==void 0&&o.activeInputs.forEach(([i])=>Lt(i,e))}he(t)&&Ut(t)},Io=t=>{Lt(t.destination,[])},xo=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),Do=(t,e,n,r,s,o,i,a)=>class extends t{constructor(l,u){const d=o(l),m=i(d),y=s(d,u,m),f=m?e(a):null;super(l,!1,y,f),this._isNodeOfNativeOfflineAudioContext=m,this._nativeAudioDestinationNode=y}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},Bo=t=>{const e=new WeakMap,n=async(r,s)=>{const o=s.destination;return e.set(s,o),await t(r,s,o),o};return{render(r,s){const o=e.get(s);return o!==void 0?Promise.resolve(o):n(r,s)}}},Wo=(t,e,n,r,s,o,i,a)=>(c,l)=>{const u=l.listener,d=()=>{const g=new Float32Array(1),_=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),b=i(l);let E=!1,M=[0,0,-1,0,1,0],S=[0,0,0];const k=()=>{if(E)return;E=!0;const B=r(l,256,9,0);B.onaudioprocess=({inputBuffer:R})=>{const D=[o(R,g,0),o(R,g,1),o(R,g,2),o(R,g,3),o(R,g,4),o(R,g,5)];D.some((N,P)=>N!==M[P])&&(u.setOrientation(...D),M=D);const U=[o(R,g,6),o(R,g,7),o(R,g,8)];U.some((N,P)=>N!==S[P])&&(u.setPosition(...U),S=U)},_.connect(B)},L=B=>R=>{R!==M[B]&&(M[B]=R,u.setOrientation(...M))},I=B=>R=>{R!==S[B]&&(S[B]=R,u.setPosition(...S))},x=(B,R,D)=>{const U=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:R});U.connect(_,0,B),U.start(),Object.defineProperty(U.offset,"defaultValue",{get(){return R}});const N=t({context:c},b,U.offset,Vt,it);return a(N,"value",P=>()=>P.call(N),P=>V=>{try{P.call(N,V)}catch($){if($.code!==9)throw $}k(),b&&D(V)}),N.cancelAndHoldAtTime=(P=>b?()=>{throw s()}:(...V)=>{const $=P.apply(N,V);return k(),$})(N.cancelAndHoldAtTime),N.cancelScheduledValues=(P=>b?()=>{throw s()}:(...V)=>{const $=P.apply(N,V);return k(),$})(N.cancelScheduledValues),N.exponentialRampToValueAtTime=(P=>b?()=>{throw s()}:(...V)=>{const $=P.apply(N,V);return k(),$})(N.exponentialRampToValueAtTime),N.linearRampToValueAtTime=(P=>b?()=>{throw s()}:(...V)=>{const $=P.apply(N,V);return k(),$})(N.linearRampToValueAtTime),N.setTargetAtTime=(P=>b?()=>{throw s()}:(...V)=>{const $=P.apply(N,V);return k(),$})(N.setTargetAtTime),N.setValueAtTime=(P=>b?()=>{throw s()}:(...V)=>{const $=P.apply(N,V);return k(),$})(N.setValueAtTime),N.setValueCurveAtTime=(P=>b?()=>{throw s()}:(...V)=>{const $=P.apply(N,V);return k(),$})(N.setValueCurveAtTime),N};return{forwardX:x(0,0,L(0)),forwardY:x(1,0,L(1)),forwardZ:x(2,-1,L(2)),positionX:x(6,0,I(0)),positionY:x(7,0,I(1)),positionZ:x(8,0,I(2)),upX:x(3,0,L(3)),upY:x(4,1,L(4)),upZ:x(5,0,L(5))}},{forwardX:m,forwardY:y,forwardZ:f,positionX:h,positionY:v,positionZ:p,upX:C,upY:w,upZ:A}=u.forwardX===void 0?d():u;return{get forwardX(){return m},get forwardY(){return y},get forwardZ(){return f},get positionX(){return h},get positionY(){return v},get positionZ(){return p},get upX(){return C},get upY(){return w},get upZ(){return A}}},Qe=t=>"context"in t,Ue=t=>Qe(t[0]),ye=(t,e,n,r)=>{for(const s of t)if(n(s)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},Mn=(t,e,[n,r],s)=>{ye(t,[e,n,r],o=>o[0]===e&&o[1]===n,s)},kn=(t,[e,n,r],s)=>{const o=t.get(e);o===void 0?t.set(e,new Set([[n,r]])):ye(o,[n,r],i=>i[0]===n,s)},fr=t=>"inputs"in t,It=(t,e,n,r)=>{if(fr(e)){const s=e.inputs[r];return t.connect(s,n,0),[s,n,0]}return t.connect(e,n,r),[e,n,r]},pr=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},Uo=(t,e,n)=>ot(t,r=>r[0]===e&&r[1]===n),mr=(t,e)=>{if(!Be(t).delete(e))throw new Error("Missing the expected event listener.")},gr=(t,e,n)=>{const r=te(t,e),s=ot(r,o=>o[0]===n);return r.size===0&&t.delete(e),s},xt=(t,e,n,r)=>{fr(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},J=t=>te(rr,t),Ie=t=>te(or,t),pe=t=>St.has(t),ze=t=>!ke.has(t),Nn=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),s=t.createGain(),o=t.createBuffer(1,2,44100),i=o.getChannelData(0);i[0]=1,i[1]=1;const a=t.createBufferSource();a.buffer=o,a.loop=!0,a.connect(r).connect(t.destination),a.connect(s),a.disconnect(s),r.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),yt=(t,e)=>{const n=new Map;for(const r of t)for(const s of r){const o=n.get(s);n.set(s,o===void 0?1:o+1)}n.forEach((r,s)=>e(s,r))},Je=t=>"context"in t,Vo=t=>{const e=new Map;t.connect=(n=>(r,s=0,o=0)=>{const i=Je(r)?n(r,s,o):n(r,s),a=e.get(r);return a===void 0?e.set(r,[{input:o,output:s}]):a.every(c=>c.input!==o||c.output!==s)&&a.push({input:o,output:s}),i})(t.connect.bind(t)),t.disconnect=(n=>(r,s,o)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[i,a]of e){const c=a.filter(l=>l.output!==r);c.length===0?e.delete(i):e.set(i,c)}else if(e.has(r))if(s===void 0)e.delete(r);else{const i=e.get(r);if(i!==void 0){const a=i.filter(c=>c.output!==s&&(c.input!==o||o===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[i,a]of e)a.forEach(c=>{Je(i)?t.connect(i,c.output,c.input):t.connect(i,c.output)})})(t.disconnect)},Fo=(t,e,n,r)=>{const{activeInputs:s,passiveInputs:o}=We(e),{outputs:i}=Z(t),a=Be(t),c=l=>{const u=J(t),d=Ie(e);if(l){const m=gr(o,t,n);Mn(s,t,m,!1),!r&&!pe(t)&&u.connect(d,n)}else{const m=Uo(s,t,n);kn(o,m,!1),!r&&!pe(t)&&u.disconnect(d,n)}};return ye(i,[e,n],l=>l[0]===e&&l[1]===n,!0)?(a.add(c),he(t)?Mn(s,t,[n,c],!0):kn(o,[t,n,c],!0),!0):!1},jo=(t,e,n,r)=>{const{activeInputs:s,passiveInputs:o}=Z(e),i=pr(s[r],t,n);return i===null?[lr(o,t,n,r)[2],!1]:[i[2],!0]},qo=(t,e,n)=>{const{activeInputs:r,passiveInputs:s}=We(e),o=pr(r,t,n);return o===null?[gr(s,t,n)[1],!1]:[o[2],!0]},Ft=(t,e,n,r,s)=>{const[o,i]=jo(t,n,r,s);if(o!==null&&(mr(t,o),i&&!e&&!pe(t)&&xt(J(t),J(n),r,s)),he(n)){const{activeInputs:a}=Z(n);Pt(n,a)}},jt=(t,e,n,r)=>{const[s,o]=qo(t,n,r);s!==null&&(mr(t,s),o&&!e&&!pe(t)&&J(t).disconnect(Ie(n),r))},$o=(t,e)=>{const n=Z(t),r=[];for(const s of n.outputs)Ue(s)?Ft(t,e,...s):jt(t,e,...s),r.push(s[0]);return n.outputs.clear(),r},Go=(t,e,n)=>{const r=Z(t),s=[];for(const o of r.outputs)o[1]===n&&(Ue(o)?Ft(t,e,...o):jt(t,e,...o),s.push(o[0]),r.outputs.delete(o));return s},zo=(t,e,n,r,s)=>{const o=Z(t);return Array.from(o.outputs).filter(i=>i[0]===n&&(r===void 0||i[1]===r)&&(s===void 0||i[2]===s)).map(i=>(Ue(i)?Ft(t,e,...i):jt(t,e,...i),o.outputs.delete(i),i[0]))},Ho=(t,e,n,r,s,o,i,a,c,l,u,d,m,y,f,h)=>class extends l{constructor(p,C,w,A){super(w),this._context=p,this._nativeAudioNode=w;const g=u(p);d(g)&&n(Nn,()=>Nn(g,h))!==!0&&Vo(w),rr.set(this,w),ar.set(this,new Set),p.state!=="closed"&&C&&Ke(this),t(this,A,w)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(p){this._nativeAudioNode.channelCount=p}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(p){this._nativeAudioNode.channelCountMode=p}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(p){this._nativeAudioNode.channelInterpretation=p}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(p,C=0,w=0){if(C<0||C>=this._nativeAudioNode.numberOfOutputs)throw s();const A=u(this._context),g=f(A);if(m(p)||y(p))throw o();if(Qe(p)){const E=J(p);try{const S=It(this._nativeAudioNode,E,C,w),k=ze(this);(g||k)&&this._nativeAudioNode.disconnect(...S),this.context.state!=="closed"&&!k&&ze(p)&&Ke(p)}catch(S){throw S.code===12?o():S}if(e(this,p,C,w,g)){const S=c([this],p);yt(S,r(g))}return p}const _=Ie(p);if(_.name==="playbackRate"&&_.maxValue===1024)throw i();try{this._nativeAudioNode.connect(_,C),(g||ze(this))&&this._nativeAudioNode.disconnect(_,C)}catch(E){throw E.code===12?o():E}if(Fo(this,p,C,g)){const E=c([this],p);yt(E,r(g))}}disconnect(p,C,w){let A;const g=u(this._context),_=f(g);if(p===void 0)A=$o(this,_);else if(typeof p=="number"){if(p<0||p>=this.numberOfOutputs)throw s();A=Go(this,_,p)}else{if(C!==void 0&&(C<0||C>=this.numberOfOutputs)||Qe(p)&&w!==void 0&&(w<0||w>=p.numberOfInputs))throw s();if(A=zo(this,_,p,C,w),A.length===0)throw o()}for(const b of A){const E=c([this],b);yt(E,a)}}},Xo=(t,e,n,r,s,o,i,a,c,l,u,d,m)=>(y,f,h,v=null,p=null)=>{const C=h.value,w=new oo(C),A=f?r(w):null,g={get defaultValue(){return C},get maxValue(){return v===null?h.maxValue:v},get minValue(){return p===null?h.minValue:p},get value(){return h.value},set value(_){h.value=_,g.setValueAtTime(_,y.context.currentTime)},cancelAndHoldAtTime(_){if(typeof h.cancelAndHoldAtTime=="function")A===null&&w.flush(y.context.currentTime),w.add(s(_)),h.cancelAndHoldAtTime(_);else{const b=Array.from(w).pop();A===null&&w.flush(y.context.currentTime),w.add(s(_));const E=Array.from(w).pop();h.cancelScheduledValues(_),b!==E&&E!==void 0&&(E.type==="exponentialRampToValue"?h.exponentialRampToValueAtTime(E.value,E.endTime):E.type==="linearRampToValue"?h.linearRampToValueAtTime(E.value,E.endTime):E.type==="setValue"?h.setValueAtTime(E.value,E.startTime):E.type==="setValueCurve"&&h.setValueCurveAtTime(E.values,E.startTime,E.duration))}return g},cancelScheduledValues(_){return A===null&&w.flush(y.context.currentTime),w.add(o(_)),h.cancelScheduledValues(_),g},exponentialRampToValueAtTime(_,b){if(_===0)throw new RangeError;if(!Number.isFinite(b)||b<0)throw new RangeError;const E=y.context.currentTime;return A===null&&w.flush(E),Array.from(w).length===0&&(w.add(l(C,E)),h.setValueAtTime(C,E)),w.add(i(_,b)),h.exponentialRampToValueAtTime(_,b),g},linearRampToValueAtTime(_,b){const E=y.context.currentTime;return A===null&&w.flush(E),Array.from(w).length===0&&(w.add(l(C,E)),h.setValueAtTime(C,E)),w.add(a(_,b)),h.linearRampToValueAtTime(_,b),g},setTargetAtTime(_,b,E){return A===null&&w.flush(y.context.currentTime),w.add(c(_,b,E)),h.setTargetAtTime(_,b,E),g},setValueAtTime(_,b){return A===null&&w.flush(y.context.currentTime),w.add(l(_,b)),h.setValueAtTime(_,b),g},setValueCurveAtTime(_,b,E){const M=_ instanceof Float32Array?_:new Float32Array(_);if(d!==null&&d.name==="webkitAudioContext"){const S=b+E,k=y.context.sampleRate,L=Math.ceil(b*k),I=Math.floor(S*k),x=I-L,B=new Float32Array(x);for(let D=0;D<x;D+=1){const U=(M.length-1)/E*((L+D)/k-b),N=Math.floor(U),P=Math.ceil(U);B[D]=N===P?M[N]:(1-(U-N))*M[N]+(1-(P-U))*M[P]}A===null&&w.flush(y.context.currentTime),w.add(u(B,b,E)),h.setValueCurveAtTime(B,b,E);const R=I/k;R<S&&m(g,B[B.length-1],R),m(g,M[M.length-1],S)}else A===null&&w.flush(y.context.currentTime),w.add(u(M,b,E)),h.setValueCurveAtTime(M,b,E);return g}};return n.set(g,h),e.set(g,y),t(g,A),g},Yo=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:s}=n;e.exponentialRampToValueAtTime(s,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:s}=n;e.linearRampToValueAtTime(s,r)}else if(n.type==="setTarget"){const{startTime:r,target:s,timeConstant:o}=n;e.setTargetAtTime(s,r,o)}else if(n.type==="setValue"){const{startTime:r,value:s}=n;e.setValueAtTime(s,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:s,values:o}=n;e.setValueCurveAtTime(o,s,r)}else throw new Error("Can't apply an unknown automation.")}});class vr{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,s)=>e.call(n,r,s,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const Zo={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},Ko=(t,e,n,r,s,o,i,a,c,l,u,d,m,y)=>class extends e{constructor(h,v,p){var C;const w=a(h),A=c(w),g=u({...Zo,...p});m(g);const _=Ot.get(w),b=_==null?void 0:_.get(v),E=A||w.state!=="closed"?w:(C=i(w))!==null&&C!==void 0?C:w,M=s(E,A?null:h.baseLatency,l,v,b,g),S=A?r(v,g,b):null;super(h,!0,M,S);const k=[];M.parameters.forEach((I,x)=>{const B=n(this,A,I);k.push([x,B])}),this._nativeAudioWorkletNode=M,this._onprocessorerror=null,this._parameters=new vr(k),A&&t(w,this);const{activeInputs:L}=o(this);d(M,L)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(h){const v=typeof h=="function"?y(this,h):null;this._nativeAudioWorkletNode.onprocessorerror=v;const p=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=p!==null&&p===v?h:p}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function et(t,e,n,r,s){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,s);else{const o=t.getChannelData(r);if(e[n].byteLength===0)e[n]=o.slice(s,s+128);else{const i=new Float32Array(o.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(i)}}}const yr=(t,e,n,r,s)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,s):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],s)},tt=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const s=[],o=typeof e=="number"?e:e[r];for(let i=0;i<o;i+=1)s.push(new Float32Array(128));n.push(s)}return n},Qo=(t,e)=>{const n=te(Rt,t),r=J(e);return te(n,r)},Jo=async(t,e,n,r,s,o,i)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,l=s.reduce((v,p)=>v+p,0),u=l===0?null:n.createBuffer(l,a,n.sampleRate);if(o===void 0)throw new Error("Missing the processor constructor.");const d=Z(t),m=await Qo(n,t),y=tt(r.numberOfInputs,r.channelCount),f=tt(r.numberOfOutputs,s),h=Array.from(t.parameters.keys()).reduce((v,p)=>({...v,[p]:new Float32Array(128)}),{});for(let v=0;v<a;v+=128){if(r.numberOfInputs>0&&e!==null)for(let p=0;p<r.numberOfInputs;p+=1)for(let C=0;C<r.channelCount;C+=1)et(e,y[p],C,C,v);o.parameterDescriptors!==void 0&&e!==null&&o.parameterDescriptors.forEach(({name:p},C)=>{et(e,h,p,c+C,v)});for(let p=0;p<r.numberOfInputs;p+=1)for(let C=0;C<s[p];C+=1)f[p][C].byteLength===0&&(f[p][C]=new Float32Array(128));try{const p=y.map((w,A)=>d.activeInputs[A].size===0?[]:w),C=i(v/n.sampleRate,n.sampleRate,()=>m.process(p,f,h));if(u!==null)for(let w=0,A=0;w<r.numberOfOutputs;w+=1){for(let g=0;g<s[w];g+=1)yr(u,f[w],g,A+g,v);A+=s[w]}if(!C)break}catch(p){t.dispatchEvent(new ErrorEvent("processorerror",{colno:p.colno,filename:p.filename,lineno:p.lineno,message:p.message}));break}}return u},ei=(t,e,n,r,s,o,i,a,c,l,u,d,m,y,f,h)=>(v,p,C)=>{const w=new WeakMap;let A=null;const g=async(_,b)=>{let E=u(_),M=null;const S=dr(E,b),k=Array.isArray(p.outputChannelCount)?p.outputChannelCount:Array.from(p.outputChannelCount);if(d===null){const L=k.reduce((R,D)=>R+D,0),I=s(b,{channelCount:Math.max(1,L),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,L)}),x=[];for(let R=0;R<_.numberOfOutputs;R+=1)x.push(r(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:k[R]}));const B=i(b,{channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:1});B.connect=e.bind(null,x),B.disconnect=c.bind(null,x),M=[I,x,B]}else S||(E=new d(b,v));if(w.set(b,M===null?E:M[2]),M!==null){if(A===null){if(C===void 0)throw new Error("Missing the processor constructor.");if(m===null)throw new Error("Missing the native OfflineAudioContext constructor.");const D=_.channelCount*_.numberOfInputs,U=C.parameterDescriptors===void 0?0:C.parameterDescriptors.length,N=D+U;A=Jo(_,N===0?null:await(async()=>{const V=new m(N,Math.ceil(_.context.length/128)*128,b.sampleRate),$=[],we=[];for(let j=0;j<p.numberOfInputs;j+=1)$.push(i(V,{channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:1})),we.push(s(V,{channelCount:p.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:p.channelCount}));const _e=await Promise.all(Array.from(_.parameters.values()).map(async j=>{const K=o(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:j.value});return await y(V,j,K.offset),K})),Ee=r(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,D+U)});for(let j=0;j<p.numberOfInputs;j+=1){$[j].connect(we[j]);for(let K=0;K<p.channelCount;K+=1)we[j].connect(Ee,K,j*p.channelCount+K)}for(const[j,K]of _e.entries())K.connect(Ee,0,D+j),K.start(0);return Ee.connect(V.destination),await Promise.all($.map(j=>f(_,V,j))),h(V)})(),b,p,k,C,l)}const L=await A,I=n(b,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[x,B,R]=M;L!==null&&(I.buffer=L,I.start(0)),I.connect(x);for(let D=0,U=0;D<_.numberOfOutputs;D+=1){const N=B[D];for(let P=0;P<k[D];P+=1)x.connect(N,U+P,P);U+=k[D]}return R}if(S)for(const[L,I]of _.parameters.entries())await t(b,I,E.parameters.get(L));else for(const[L,I]of _.parameters.entries())await y(b,I,E.parameters.get(L));return await f(_,b,E),E};return{render(_,b){a(b,_);const E=w.get(b);return E!==void 0?Promise.resolve(E):g(_,b)}}},ti=(t,e)=>(n,r)=>{const s=e.get(n);if(s!==void 0)return s;const o=t.get(n);if(o!==void 0)return o;try{const i=r();return i instanceof Promise?(t.set(n,i),i.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,i),i)}catch{return e.set(n,!1),!1}},ni=t=>(e,n,r)=>t(n,e,r),ri=t=>(e,n,r=0,s=0)=>{const o=e[r];if(o===void 0)throw t();return Je(n)?o.connect(n,0,s):o.connect(n,0)},si=t=>e=>(t[0]=e,t[0]),oi=(t,e,n,r,s,o,i,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const d=o(c.context),m=a(d);if(u===l){if(e.delete(c),!m&&i(c)){const y=r(c),{outputs:f}=n(c);for(const h of f)if(Ue(h)){const v=r(h[0]);t(y,v,h[1],h[2])}else{const v=s(h[0]);y.connect(v,h[1])}}}else e.set(c,u-l)},ii=t=>(e,n,r,s)=>t(e[s],o=>o[0]===n&&o[1]===r),ai=t=>(e,n)=>{t(e).delete(n)},ci=t=>"delayTime"in t,li=(t,e,n)=>function r(s,o){const i=Qe(o)?o:n(t,o);if(ci(i))return[];if(s[0]===i)return[s];if(s.includes(i))return[];const{outputs:a}=e(i);return Array.from(a).map(c=>r([...s,i],c[0])).reduce((c,l)=>c.concat(l),[])},$e=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},ui=t=>(e,n=void 0,r=void 0,s=0)=>n===void 0?e.forEach(o=>o.disconnect()):typeof n=="number"?$e(t,e,n).disconnect():Je(n)?r===void 0?e.forEach(o=>o.disconnect(n)):s===void 0?$e(t,e,r).disconnect(n,0):$e(t,e,r).disconnect(n,0,s):r===void 0?e.forEach(o=>o.disconnect(n)):$e(t,e,r).disconnect(n,0),di=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const s=t.document.head;if(s===null)r(new SyntaxError);else{const o=t.document.createElement("script"),i=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(i),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(u,d,m,y,f)=>{if(d===a||d===t.location.href&&m===1&&y===1)return l(),r(f),!1;if(c!==null)return c(u,d,m,y,f)},o.onerror=()=>{l(),r(new SyntaxError)},o.onload=()=>{l(),n()},o.src=a,o.type="module",s.appendChild(o)}}),hi=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,s){if(r!==null){let o=this._listeners.get(r);o===void 0&&(o=t(this,r),typeof r=="function"&&this._listeners.set(r,o)),this._nativeEventTarget.addEventListener(n,o,s)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,s){const o=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,o===void 0?null:o,s)}},fi=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},pi=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},mi=(t,e)=>n=>e(t,n),gi=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},vi=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},yi=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},bi=t=>e=>t.get(e),ee=()=>new DOMException("","InvalidStateError"),wi=t=>e=>{const n=t.get(e);if(n===void 0)throw ee();return n},_i=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},Ei=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},Ci=()=>new DOMException("","InvalidAccessError"),Ai=(t,e,n,r,s,o)=>i=>(a,c)=>{const l=t.get(a);if(l===void 0){if(!i&&o(a)){const u=r(a),{outputs:d}=n(a);for(const m of d)if(Ue(m)){const y=r(m[0]);e(u,y,m[1],m[2])}else{const y=s(m[0]);u.disconnect(y,m[1])}}t.set(a,c)}else t.set(a,l+c)},Ti=t=>e=>t!==null&&e instanceof t,Mi=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,ki=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,Ni=t=>e=>t!==null&&e instanceof t,Si=t=>t!==null&&t.isSecureContext,Oi=(t,e,n,r)=>class extends t{constructor(o,i){const a=n(o),c=e(a,i);if(r(a))throw new TypeError;super(o,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},Ri=(t,e,n,r,s)=>class extends r{constructor(i={}){if(s===null)throw new Error("Missing the native AudioContext constructor.");let a;try{a=new s(i)}catch(u){throw u.code===12&&u.message==="sampleRate is not in range"?e():u}if(a===null)throw n();if(!xo(i.latencyHint))throw new TypeError(`The provided value '${i.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(i.sampleRate!==void 0&&a.sampleRate!==i.sampleRate)throw e();super(a,2);const{latencyHint:c}=i,{sampleRate:l}=a;if(this._baseLatency=typeof a.baseLatency=="number"?a.baseLatency:c==="balanced"?512/l:c==="interactive"||c===void 0?256/l:c==="playback"?1024/l:Math.max(2,Math.min(128,Math.round(c*l/128)))*128/l,this._nativeAudioContext=a,s.name==="webkitAudioContext"?(this._nativeGainNode=a.createGain(),this._nativeOscillatorNode=a.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(a.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,a.state==="running"){this._state="suspended";const u=()=>{this._state==="suspended"&&(this._state=null),a.removeEventListener("statechange",u)};a.addEventListener("statechange",u)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),Io(this)}))}resume(){return this._state==="suspended"?new Promise((i,a)=>{const c=()=>{this._nativeAudioContext.removeEventListener("statechange",c),this._nativeAudioContext.state==="running"?i():this.resume().then(i,a)};this._nativeAudioContext.addEventListener("statechange",c)}):this._nativeAudioContext.resume().catch(i=>{throw i===void 0||i.code===15?t():i})}suspend(){return this._nativeAudioContext.suspend().catch(i=>{throw i===void 0?t():i})}},Pi=(t,e,n,r,s,o)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,ir.set(this,a),r(a)&&s.set(a,new Set),this._destination=new t(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?o(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Sn=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},Li=(t,e)=>(n,r,s)=>{const o=new Set;return n.connect=(i=>(a,c=0,l=0)=>{const u=o.size===0;if(e(a))return i.call(n,a,c,l),t(o,[a,c,l],d=>d[0]===a&&d[1]===c&&d[2]===l,!0),u&&r(),a;i.call(n,a,c),t(o,[a,c],d=>d[0]===a&&d[1]===c,!0),u&&r()})(n.connect),n.disconnect=(i=>(a,c,l)=>{const u=o.size>0;if(a===void 0)i.apply(n),o.clear();else if(typeof a=="number"){i.call(n,a);for(const m of o)m[1]===a&&o.delete(m)}else{e(a)?i.call(n,a,c,l):i.call(n,a,c);for(const m of o)m[0]===a&&(c===void 0||m[1]===c)&&(l===void 0||m[2]===l)&&o.delete(m)}const d=o.size===0;u&&d&&s()})(n.disconnect),n},de=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},Ve=(t,e)=>{de(t,e,"channelCount"),de(t,e,"channelCountMode"),de(t,e,"channelInterpretation")},Ii=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,qt=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},xi=t=>{t.start=(e=>{let n=!1;return(r=0,s=0,o)=>{if(n)throw ee();e.call(t,r,s,o),n=!0}})(t.start)},br=t=>{t.start=(e=>(n=0,r=0,s)=>{if(typeof s=="number"&&s<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,s)})(t.start)},wr=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},Di=(t,e,n,r,s,o,i,a,c,l,u)=>(d,m)=>{const y=d.createBufferSource();return Ve(y,m),qt(y,m,"playbackRate"),de(y,m,"buffer"),de(y,m,"loop"),de(y,m,"loopEnd"),de(y,m,"loopStart"),e(n,()=>n(d))||xi(y),e(r,()=>r(d))||c(y),e(s,()=>s(d))||l(y,d),e(o,()=>o(d))||br(y),e(i,()=>i(d))||u(y,d),e(a,()=>a(d))||wr(y),t(d,y),y},Bi=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,Wi=(t,e)=>(n,r,s)=>{const o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch{}s&&o.channelCountMode!=="explicit"&&(o.channelCountMode="explicit"),o.maxChannelCount===0&&Object.defineProperty(o,"maxChannelCount",{value:r});const i=t(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return e(i,"channelCount",a=>()=>a.call(i),a=>c=>{a.call(i,c);try{o.channelCount=c}catch(l){if(c>o.maxChannelCount)throw l}}),e(i,"channelCountMode",a=>()=>a.call(i),a=>c=>{a.call(i,c),o.channelCountMode=c}),e(i,"channelInterpretation",a=>()=>a.call(i),a=>c=>{a.call(i,c),o.channelInterpretation=c}),Object.defineProperty(i,"maxChannelCount",{get:()=>o.maxChannelCount}),i.connect(o),i},Ui=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,Vi=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},Fi=(t,e,n,r,s)=>(o,i,a,c,l,u)=>{if(a!==null)try{const d=new a(o,c,u),m=new Map;let y=null;if(Object.defineProperties(d,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>y,set:f=>{typeof y=="function"&&d.removeEventListener("processorerror",y),y=typeof f=="function"?f:null,typeof y=="function"&&d.addEventListener("processorerror",y)}}}),d.addEventListener=(f=>(...h)=>{if(h[0]==="processorerror"){const v=typeof h[1]=="function"?h[1]:typeof h[1]=="object"&&h[1]!==null&&typeof h[1].handleEvent=="function"?h[1].handleEvent:null;if(v!==null){const p=m.get(h[1]);p!==void 0?h[1]=p:(h[1]=C=>{C.type==="error"?(Object.defineProperties(C,{type:{value:"processorerror"}}),v(C)):v(new ErrorEvent(h[0],{...C}))},m.set(v,h[1]))}}return f.call(d,"error",h[1],h[2]),f.call(d,...h)})(d.addEventListener),d.removeEventListener=(f=>(...h)=>{if(h[0]==="processorerror"){const v=m.get(h[1]);v!==void 0&&(m.delete(h[1]),h[1]=v)}return f.call(d,"error",h[1],h[2]),f.call(d,h[0],h[1],h[2])})(d.removeEventListener),u.numberOfOutputs!==0){const f=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return d.connect(f).connect(o.destination),s(d,()=>f.disconnect(),()=>f.connect(o.destination))}return d}catch(d){throw d.code===11?r():d}if(l===void 0)throw r();return Vi(u),e(o,i,l,u)},ji=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),qi=t=>new Promise((e,n)=>{const{port1:r,port2:s}=new MessageChannel;r.onmessage=({data:o})=>{r.close(),s.close(),e(o)},r.onmessageerror=({data:o})=>{r.close(),s.close(),n(o)},s.postMessage(t)}),$i=async(t,e)=>{const n=await qi(e);return new t(n)},Gi=(t,e,n,r)=>{let s=Rt.get(t);s===void 0&&(s=new WeakMap,Rt.set(t,s));const o=$i(n,r);return s.set(e,o),o},zi=(t,e,n,r,s,o,i,a,c,l,u,d,m)=>(y,f,h,v)=>{if(v.numberOfInputs===0&&v.numberOfOutputs===0)throw c();const p=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(p.some(T=>T<1))throw c();if(p.length!==v.numberOfOutputs)throw e();if(v.channelCountMode!=="explicit")throw c();const C=v.channelCount*v.numberOfInputs,w=p.reduce((T,O)=>T+O,0),A=h.parameterDescriptors===void 0?0:h.parameterDescriptors.length;if(C+A>6||w>6)throw c();const g=new MessageChannel,_=[],b=[];for(let T=0;T<v.numberOfInputs;T+=1)_.push(i(y,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),b.push(s(y,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const E=[];if(h.parameterDescriptors!==void 0)for(const{defaultValue:T,maxValue:O,minValue:z,name:F}of h.parameterDescriptors){const W=o(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:v.parameterData[F]!==void 0?v.parameterData[F]:T===void 0?0:T});Object.defineProperties(W.offset,{defaultValue:{get:()=>T===void 0?0:T},maxValue:{get:()=>O===void 0?Vt:O},minValue:{get:()=>z===void 0?it:z}}),E.push(W)}const M=r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,C+A)}),S=ji(f,y.sampleRate),k=a(y,S,C+A,Math.max(1,w)),L=s(y,{channelCount:Math.max(1,w),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,w)}),I=[];for(let T=0;T<v.numberOfOutputs;T+=1)I.push(r(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:p[T]}));for(let T=0;T<v.numberOfInputs;T+=1){_[T].connect(b[T]);for(let O=0;O<v.channelCount;O+=1)b[T].connect(M,O,T*v.channelCount+O)}const x=new vr(h.parameterDescriptors===void 0?[]:h.parameterDescriptors.map(({name:T},O)=>{const z=E[O];return z.connect(M,0,C+O),z.start(0),[T,z.offset]}));M.connect(k);let B=v.channelInterpretation,R=null;const D=v.numberOfOutputs===0?[k]:I,U={get bufferSize(){return S},get channelCount(){return v.channelCount},set channelCount(T){throw n()},get channelCountMode(){return v.channelCountMode},set channelCountMode(T){throw n()},get channelInterpretation(){return B},set channelInterpretation(T){for(const O of _)O.channelInterpretation=T;B=T},get context(){return k.context},get inputs(){return _},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get onprocessorerror(){return R},set onprocessorerror(T){typeof R=="function"&&U.removeEventListener("processorerror",R),R=typeof T=="function"?T:null,typeof R=="function"&&U.addEventListener("processorerror",R)},get parameters(){return x},get port(){return g.port2},addEventListener(...T){return k.addEventListener(T[0],T[1],T[2])},connect:t.bind(null,D),disconnect:l.bind(null,D),dispatchEvent(...T){return k.dispatchEvent(T[0])},removeEventListener(...T){return k.removeEventListener(T[0],T[1],T[2])}},N=new Map;g.port1.addEventListener=(T=>(...O)=>{if(O[0]==="message"){const z=typeof O[1]=="function"?O[1]:typeof O[1]=="object"&&O[1]!==null&&typeof O[1].handleEvent=="function"?O[1].handleEvent:null;if(z!==null){const F=N.get(O[1]);F!==void 0?O[1]=F:(O[1]=W=>{u(y.currentTime,y.sampleRate,()=>z(W))},N.set(z,O[1]))}}return T.call(g.port1,O[0],O[1],O[2])})(g.port1.addEventListener),g.port1.removeEventListener=(T=>(...O)=>{if(O[0]==="message"){const z=N.get(O[1]);z!==void 0&&(N.delete(O[1]),O[1]=z)}return T.call(g.port1,O[0],O[1],O[2])})(g.port1.removeEventListener);let P=null;Object.defineProperty(g.port1,"onmessage",{get:()=>P,set:T=>{typeof P=="function"&&g.port1.removeEventListener("message",P),P=typeof T=="function"?T:null,typeof P=="function"&&(g.port1.addEventListener("message",P),g.port1.start())}}),h.prototype.port=g.port1;let V=null;Gi(y,U,h,v).then(T=>V=T);const we=tt(v.numberOfInputs,v.channelCount),_e=tt(v.numberOfOutputs,p),Ee=h.parameterDescriptors===void 0?[]:h.parameterDescriptors.reduce((T,{name:O})=>({...T,[O]:new Float32Array(128)}),{});let j=!0;const K=()=>{v.numberOfOutputs>0&&k.disconnect(L);for(let T=0,O=0;T<v.numberOfOutputs;T+=1){const z=I[T];for(let F=0;F<p[T];F+=1)L.disconnect(z,O+F,F);O+=p[T]}},Fe=new Map;k.onaudioprocess=({inputBuffer:T,outputBuffer:O})=>{if(V!==null){const z=d(U);for(let F=0;F<S;F+=128){for(let W=0;W<v.numberOfInputs;W+=1)for(let q=0;q<v.channelCount;q+=1)et(T,we[W],q,q,F);h.parameterDescriptors!==void 0&&h.parameterDescriptors.forEach(({name:W},q)=>{et(T,Ee,W,C+q,F)});for(let W=0;W<v.numberOfInputs;W+=1)for(let q=0;q<p[W];q+=1)_e[W][q].byteLength===0&&(_e[W][q]=new Float32Array(128));try{const W=we.map((Q,oe)=>{if(z[oe].size>0)return Fe.set(oe,S/128),Q;const pt=Fe.get(oe);return pt===void 0?[]:(Q.every(Xr=>Xr.every(Yr=>Yr===0))&&(pt===1?Fe.delete(oe):Fe.set(oe,pt-1)),Q)});j=u(y.currentTime+F/y.sampleRate,y.sampleRate,()=>V.process(W,_e,Ee));for(let Q=0,oe=0;Q<v.numberOfOutputs;Q+=1){for(let Oe=0;Oe<p[Q];Oe+=1)yr(O,_e[Q],Oe,oe+Oe,F);oe+=p[Q]}}catch(W){j=!1,U.dispatchEvent(new ErrorEvent("processorerror",{colno:W.colno,filename:W.filename,lineno:W.lineno,message:W.message}))}if(!j){for(let W=0;W<v.numberOfInputs;W+=1){_[W].disconnect(b[W]);for(let q=0;q<v.channelCount;q+=1)b[F].disconnect(M,q,W*v.channelCount+q)}if(h.parameterDescriptors!==void 0){const W=h.parameterDescriptors.length;for(let q=0;q<W;q+=1){const Q=E[q];Q.disconnect(M,0,C+q),Q.stop()}}M.disconnect(k),k.onaudioprocess=null,ht?K():tn();break}}}};let ht=!1;const ft=i(y,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),en=()=>k.connect(ft).connect(y.destination),tn=()=>{k.disconnect(ft),ft.disconnect()},zr=()=>{if(j){tn(),v.numberOfOutputs>0&&k.connect(L);for(let T=0,O=0;T<v.numberOfOutputs;T+=1){const z=I[T];for(let F=0;F<p[T];F+=1)L.connect(z,O+F,F);O+=p[T]}}ht=!0},Hr=()=>{j&&(en(),K()),ht=!1};return en(),m(U,zr,Hr)},Hi=(t,e)=>(n,r)=>{const s=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,s),Ve(s,r),s},Xi=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw ee()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw ee()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw ee()}})},_r=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Ve(n,e),Xi(n),n},Yi=(t,e,n,r,s)=>(o,i)=>{if(o.createConstantSource===void 0)return n(o,i);const a=o.createConstantSource();return Ve(a,i),qt(a,i,"offset"),e(r,()=>r(o))||br(a),e(s,()=>s(o))||wr(a),t(o,a),a},Er=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Zi=(t,e,n,r)=>(s,{offset:o,...i})=>{const a=s.createBuffer(1,2,44100),c=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(s,{...i,gain:o}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const d={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(f){l.channelCount=f},get channelCountMode(){return l.channelCountMode},set channelCountMode(f){l.channelCountMode=f},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(f){l.channelInterpretation=f},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(f){c.onended=f},addEventListener(...f){return c.addEventListener(f[0],f[1],f[2])},dispatchEvent(...f){return c.dispatchEvent(f[0])},removeEventListener(...f){return c.removeEventListener(f[0],f[1],f[2])},start(f=0){c.start.call(c,f)},stop(f=0){c.stop.call(c,f)}},m=()=>c.connect(l),y=()=>c.disconnect(l);return t(s,c),r(Er(d,l),m,y)},le=(t,e)=>{const n=t.createGain();return Ve(n,e),qt(n,e,"gain"),n},Ki=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((o,i)=>o.id<i.id?-1:o.id>i.id?1:0);const r=n.slice(0,1),s=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(s,"mediaStream",{value:e}),s},Qi=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,$t=(t,e,n,r)=>t.createScriptProcessor(e,n,r),be=()=>new DOMException("","NotSupportedError"),Ji=(t,e)=>(n,r,s)=>(t(r).replay(s),e(r,n,s)),ea=(t,e,n)=>async(r,s,o)=>{const i=t(r);await Promise.all(i.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const m=await e(l).render(l,s),y=r.context.destination;!n(l)&&(r!==y||!n(r))&&m.connect(o,u,c)})).reduce((a,c)=>[...a,...c],[]))},ta=(t,e,n)=>async(r,s,o)=>{const i=e(r);await Promise.all(Array.from(i.activeInputs).map(async([a,c])=>{const u=await t(a).render(a,s);n(a)||u.connect(o,c)}))},na=(t,e,n,r)=>s=>t(Sn,()=>Sn(s))?Promise.resolve(t(r,r)).then(o=>{if(!o){const i=n(s,512,0,1);s.oncomplete=()=>{i.onaudioprocess=null,i.disconnect()},i.onaudioprocess=()=>s.currentTime,i.connect(s.destination)}return s.startRendering()}):new Promise(o=>{const i=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=a=>{i.disconnect(),o(a.renderedBuffer)},i.connect(s.destination),s.startRendering()}),ra=t=>(e,n)=>{t.set(e,n)},sa=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},oa=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),s=URL.createObjectURL(n);let o=!1,i=!1;try{await r.audioWorklet.addModule(s);const a=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>o=!0,a.onprocessorerror=()=>i=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(s)}return o&&!i},ia=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(s=>{n.oncomplete=()=>{r.disconnect(),s(n.currentTime!==0)},n.startRendering()})},aa=()=>new DOMException("","UnknownError"),ca=()=>typeof window>"u"?null:window,la=(t,e)=>n=>{n.copyFromChannel=(r,s,o=0)=>{const i=t(o),a=t(s);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=i<0?-i:0;d+i<c&&d<u;d+=1)r[d]=l[d+i]},n.copyToChannel=(r,s,o=0)=>{const i=t(o),a=t(s);if(a>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(a),u=r.length;for(let d=i<0?-i:0;d+i<c&&d<u;d+=1)l[d+i]=r[d]}},ua=t=>e=>{e.copyFromChannel=(n=>(r,s,o=0)=>{const i=t(o),a=t(s);if(i<e.length)return n.call(e,r,a,i)})(e.copyFromChannel),e.copyToChannel=(n=>(r,s,o=0)=>{const i=t(o),a=t(s);if(i<e.length)return n.call(e,r,a,i)})(e.copyToChannel)},da=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",s=>()=>{const o=s.call(e);return o===r?null:o},s=>o=>s.call(e,o===null?r:o))},ha=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const s=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)s.connect(r,0,c)},()=>s.disconnect(r))},fa=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),Gt=(t,e,n,r)=>{let s=t;for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:o,set:i}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(t,e,{get:n(o),set:r(i)})},pa=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),Cr=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;Cr(t,e,n+1e-7)}},ma=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},ga=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},va=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},Ar=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},ya=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},Tr=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},ba=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},wa=t=>{t.start=(e=>(n=0,r=0,s)=>{const o=t.buffer,i=o===null?r:Math.min(o.duration,r);o!==null&&i>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,i,s)})(t.start)},_a=(t,e)=>{const n=e.createGain();t.connect(n);const r=(s=>()=>{s.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),Er(t,n),t.stop=(s=>{let o=!1;return(i=0)=>{if(o)try{s.call(t,i)}catch{n.gain.setValueAtTime(0,i)}else s.call(t,i),o=!0}})(t.stop)},at=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},Ea=fo(ye),Ca=bo(ye),Aa=ii(ot),Ta=new WeakMap,Ma=vi(Ta),Ne=ti(new Map,new WeakMap),ne=ca(),Mr=gi(Z),zt=ea(Z,Mr,pe),me=wi(ir),Se=Qi(ne),se=Ni(Se),kr=new WeakMap,Nr=hi(at),ct=Bi(ne),ka=Ti(ct),Sr=Mi(ne),Na=ki(ne),xe=Ui(ne),lt=Ho(po(nr),yo(Ea,Ca,It,Aa,xt,Z,Ma,Be,J,ye,he,pe,ze),Ne,Ai(St,xt,Z,J,Ie,he),ve,Ci,be,oi(It,St,Z,J,Ie,me,he,se),li(kr,Z,te),Nr,me,ka,Sr,Na,se,xe),Sa=new WeakSet,On=Ii(ne),Or=si(new Uint32Array(1)),Oa=la(Or,ve),Ra=ua(Or),Pa=Ao(Sa,Ne,be,On,Se,sa(On),Oa,Ra),Ht=wo(le),Rr=ta(Mr,We,pe),Pr=ni(Rr),ut=Di(Ht,Ne,ma,ga,va,Ar,ya,Tr,wa,da(Gt),_a),Lr=Ji(yi(We),Rr),La=ko(Pr,ut,J,Lr,zt),Xt=Xo(mo(sr),kr,or,Yo,io,ao,co,lo,uo,Mt,er,ct,Cr),Ia=Mo(lt,La,Xt,ee,ut,me,se,at),xa=Do(lt,Bo,ve,ee,Wi(le,Gt),me,se,zt),dt=Li(ye,Sr),Da=ha(ee,dt),Yt=Hi(ct,Da),Ba=Zi(Ht,ut,le,dt),Zt=Yi(Ht,Ne,Ba,Ar,Tr),Wa=na(Ne,le,$t,ia(le,Se)),Ua=Wo(Xt,Yt,Zt,$t,be,fa,se,Gt),Ir=new WeakMap,Va=Pi(xa,Ua,Nr,se,Ir,at),xr=Si(ne),Kt=fi(ne),Dr=new WeakMap,Fa=_i(Dr,Se),Rn=xr?vo(Ne,be,di(ne),Kt,pi(ho),me,Fa,se,xe,new WeakMap,new WeakMap,oa(xe,Se),ne):void 0,ja=Oi(lt,Ki,me,se),Br=Ei(Ir),qa=_o(Br),Wr=ri(ve),$a=ai(Br),Ur=ui(ve),Vr=new WeakMap,Ga=mi(Vr,te),za=zi(Wr,ve,ee,Yt,_r,Zt,le,$t,be,Ur,Kt,Ga,dt),Ha=Fi(ee,za,le,be,dt),Xa=ei(Pr,Wr,ut,Yt,_r,Zt,le,$a,Ur,Kt,J,xe,Se,Lr,zt,Wa),Ya=bi(Dr),Za=ra(Vr),Pn=xr?Ko(qa,lt,Xt,Xa,Ha,Z,Ya,me,se,xe,pa,Za,ba,at):void 0,Ka=Ri(ee,be,aa,Va,ct),Fr="Missing AudioWorklet support. Maybe this is not running in a secure context.",Qa=async(t,e,n,r,s)=>{const{encoderId:o,port:i}=await Qn(s,e.sampleRate);if(Pn===void 0)throw new Error(Fr);const a=new Ia(e,{buffer:t}),c=new ja(e,{mediaStream:r}),l=no(Pn,e,{channelCount:n});return{audioBufferSourceNode:a,encoderId:o,mediaStreamAudioSourceNode:c,port:i,recorderAudioWorkletNode:l}},Ja=(t,e,n,r)=>(s,o,i)=>{var a;const c=(a=o.getAudioTracks()[0])===null||a===void 0?void 0:a.getSettings().sampleRate,l=new Ka({latencyHint:"playback",sampleRate:c}),u=Math.max(1024,Math.ceil(l.baseLatency*l.sampleRate)),d=new Pa({length:u,sampleRate:l.sampleRate}),m=[],y=to(E=>{if(Rn===void 0)throw new Error(Fr);return Rn(l,E)});let f=null,h=null,v=null,p=null,C=!0;const w=E=>{s.dispatchEvent(t("dataavailable",{data:new Blob(E,{type:i})}))},A=async(E,M)=>{const S=await Xe(E,M);v===null?m.push(...S):(w(S),p=A(E,M))},g=()=>(C=!0,l.resume()),_=()=>{v!==null&&(f!==null&&(o.removeEventListener("addtrack",f),o.removeEventListener("removetrack",f)),h!==null&&clearTimeout(h),v.then(async({encoderId:E,mediaStreamAudioSourceNode:M,recorderAudioWorkletNode:S})=>{p!==null&&(p.catch(()=>{}),p=null),await S.stop(),M.disconnect(S);const k=await Xe(E,null);v===null&&await b(),w([...m,...k]),m.length=0,s.dispatchEvent(new Event("stop"))}),v=null)},b=()=>(C=!1,l.suspend());return b(),{get mimeType(){return i},get state(){return v===null?"inactive":C?"recording":"paused"},pause(){if(v===null)throw n();C&&(b(),s.dispatchEvent(new Event("pause")))},resume(){if(v===null)throw n();C||(g(),s.dispatchEvent(new Event("resume")))},start(E){var M;if(v!==null)throw n();if(o.getVideoTracks().length>0)throw r();s.dispatchEvent(new Event("start"));const S=o.getAudioTracks(),k=S.length===0?2:(M=S[0].getSettings().channelCount)!==null&&M!==void 0?M:2;v=Promise.all([g(),y.then(()=>Qa(d,l,k,o,i))]).then(async([,{audioBufferSourceNode:I,encoderId:x,mediaStreamAudioSourceNode:B,port:R,recorderAudioWorkletNode:D}])=>(B.connect(D),await new Promise(U=>{I.onended=U,I.connect(D),I.start(l.currentTime+u/l.sampleRate)}),I.disconnect(D),await D.record(R),E!==void 0&&(p=A(x,E)),{encoderId:x,mediaStreamAudioSourceNode:B,recorderAudioWorkletNode:D}));const L=o.getTracks();f=()=>{_(),s.dispatchEvent(new ErrorEvent("error",{error:e()}))},o.addEventListener("addtrack",f),o.addEventListener("removetrack",f),h=setInterval(()=>{const I=o.getTracks();(I.length!==L.length||I.some((x,B)=>x!==L[B]))&&f!==null&&f()},1e3)},stop:_}};class bt{constructor(e,n=0,r){if(n<0||r!==void 0&&r<0)throw new RangeError;const s=e.reduce((u,d)=>u+d.byteLength,0);if(n>s||r!==void 0&&n+r>s)throw new RangeError;const o=[],i=r===void 0?s-n:r,a=[];let c=0,l=n;for(const u of e)if(a.length===0)if(u.byteLength>l){c=u.byteLength-l;const d=c>i?i:c;o.push(new DataView(u,l,d)),a.push(u)}else l-=u.byteLength;else if(c<i){c+=u.byteLength;const d=c>i?u.byteLength-c+i:u.byteLength;o.push(new DataView(u,0,d)),a.push(u)}this._buffers=a,this._byteLength=i,this._byteOffset=l,this._dataViews=o,this._internalBuffer=new DataView(new ArrayBuffer(8))}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get byteOffset(){return this._byteOffset}getFloat32(e,n){return this._internalBuffer.setUint8(0,this.getUint8(e+0)),this._internalBuffer.setUint8(1,this.getUint8(e+1)),this._internalBuffer.setUint8(2,this.getUint8(e+2)),this._internalBuffer.setUint8(3,this.getUint8(e+3)),this._internalBuffer.getFloat32(0,n)}getFloat64(e,n){return this._internalBuffer.setUint8(0,this.getUint8(e+0)),this._internalBuffer.setUint8(1,this.getUint8(e+1)),this._internalBuffer.setUint8(2,this.getUint8(e+2)),this._internalBuffer.setUint8(3,this.getUint8(e+3)),this._internalBuffer.setUint8(4,this.getUint8(e+4)),this._internalBuffer.setUint8(5,this.getUint8(e+5)),this._internalBuffer.setUint8(6,this.getUint8(e+6)),this._internalBuffer.setUint8(7,this.getUint8(e+7)),this._internalBuffer.getFloat64(0,n)}getInt16(e,n){return this._internalBuffer.setUint8(0,this.getUint8(e+0)),this._internalBuffer.setUint8(1,this.getUint8(e+1)),this._internalBuffer.getInt16(0,n)}getInt32(e,n){return this._internalBuffer.setUint8(0,this.getUint8(e+0)),this._internalBuffer.setUint8(1,this.getUint8(e+1)),this._internalBuffer.setUint8(2,this.getUint8(e+2)),this._internalBuffer.setUint8(3,this.getUint8(e+3)),this._internalBuffer.getInt32(0,n)}getInt8(e){const[n,r]=this._findDataViewWithOffset(e);return n.getInt8(e-r)}getUint16(e,n){return this._internalBuffer.setUint8(0,this.getUint8(e+0)),this._internalBuffer.setUint8(1,this.getUint8(e+1)),this._internalBuffer.getUint16(0,n)}getUint32(e,n){return this._internalBuffer.setUint8(0,this.getUint8(e+0)),this._internalBuffer.setUint8(1,this.getUint8(e+1)),this._internalBuffer.setUint8(2,this.getUint8(e+2)),this._internalBuffer.setUint8(3,this.getUint8(e+3)),this._internalBuffer.getUint32(0,n)}getUint8(e){const[n,r]=this._findDataViewWithOffset(e);return n.getUint8(e-r)}setFloat32(e,n,r){this._internalBuffer.setFloat32(0,n,r),this.setUint8(e,this._internalBuffer.getUint8(0)),this.setUint8(e+1,this._internalBuffer.getUint8(1)),this.setUint8(e+2,this._internalBuffer.getUint8(2)),this.setUint8(e+3,this._internalBuffer.getUint8(3))}setFloat64(e,n,r){this._internalBuffer.setFloat64(0,n,r),this.setUint8(e,this._internalBuffer.getUint8(0)),this.setUint8(e+1,this._internalBuffer.getUint8(1)),this.setUint8(e+2,this._internalBuffer.getUint8(2)),this.setUint8(e+3,this._internalBuffer.getUint8(3)),this.setUint8(e+4,this._internalBuffer.getUint8(4)),this.setUint8(e+5,this._internalBuffer.getUint8(5)),this.setUint8(e+6,this._internalBuffer.getUint8(6)),this.setUint8(e+7,this._internalBuffer.getUint8(7))}setInt16(e,n,r){this._internalBuffer.setInt16(0,n,r),this.setUint8(e,this._internalBuffer.getUint8(0)),this.setUint8(e+1,this._internalBuffer.getUint8(1))}setInt32(e,n,r){this._internalBuffer.setInt32(0,n,r),this.setUint8(e,this._internalBuffer.getUint8(0)),this.setUint8(e+1,this._internalBuffer.getUint8(1)),this.setUint8(e+2,this._internalBuffer.getUint8(2)),this.setUint8(e+3,this._internalBuffer.getUint8(3))}setInt8(e,n){const[r,s]=this._findDataViewWithOffset(e);r.setInt8(e-s,n)}setUint16(e,n,r){this._internalBuffer.setUint16(0,n,r),this.setUint8(e,this._internalBuffer.getUint8(0)),this.setUint8(e+1,this._internalBuffer.getUint8(1))}setUint32(e,n,r){this._internalBuffer.setUint32(0,n,r),this.setUint8(e,this._internalBuffer.getUint8(0)),this.setUint8(e+1,this._internalBuffer.getUint8(1)),this.setUint8(e+2,this._internalBuffer.getUint8(2)),this.setUint8(e+3,this._internalBuffer.getUint8(3))}setUint8(e,n){const[r,s]=this._findDataViewWithOffset(e);r.setUint8(e-s,n)}_findDataViewWithOffset(e){let n=0;for(const r of this._dataViews){const s=n+r.byteLength;if(e>=n&&e<s)return[r,n];n=s}throw new RangeError}}const ec=(t,e,n)=>(r,s,o,i)=>{const a=[],c=new s(o,{mimeType:"audio/webm;codecs=pcm"});let l=null,u=()=>{};const d=f=>{r.dispatchEvent(t("dataavailable",{data:new Blob(f,{type:i})}))},m=async(f,h)=>{const v=await Xe(f,h);c.state==="inactive"?a.push(...v):(d(v),l=m(f,h))},y=()=>{c.state!=="inactive"&&(l!==null&&(l.catch(()=>{}),l=null),u(),u=()=>{},c.stop())};return c.addEventListener("error",f=>{y(),r.dispatchEvent(new ErrorEvent("error",{error:f.error}))}),c.addEventListener("pause",()=>r.dispatchEvent(new Event("pause"))),c.addEventListener("resume",()=>r.dispatchEvent(new Event("resume"))),c.addEventListener("start",()=>r.dispatchEvent(new Event("start"))),{get mimeType(){return i},get state(){return c.state},pause(){return c.pause()},resume(){return c.resume()},start(f){const[h]=o.getAudioTracks();if(h!==void 0&&c.state==="inactive"){const{channelCount:v,sampleRate:p}=h.getSettings();if(v===void 0)throw new Error("The channelCount is not defined.");if(p===void 0)throw new Error("The sampleRate is not defined.");let C=!1,w=!1,A=0,g=Qn(i,p);u=()=>{w=!0};const _=Jn(c,"dataavailable")(({data:b})=>{A+=1;const E=b.arrayBuffer();g=g.then(async({dataView:M=null,elementType:S=null,encoderId:k,port:L})=>{const I=await E;A-=1;const x=M===null?new bt([I]):new bt([...M.buffers,I],M.byteOffset);if(!C&&c.state==="recording"&&!w){const N=n(x,0);if(N===null)return{dataView:x,elementType:S,encoderId:k,port:L};const{value:P}=N;if(P!==172351395)return{dataView:M,elementType:S,encoderId:k,port:L};C=!0}const{currentElementType:B,offset:R,contents:D}=e(x,S,v),U=R<x.byteLength?new bt(x.buffers,x.byteOffset+R):null;return D.forEach(N=>L.postMessage(N,N.map(({buffer:P})=>P))),A===0&&(c.state==="inactive"||w)&&(Xe(k,null).then(N=>{d([...a,...N]),a.length=0,r.dispatchEvent(new Event("stop"))}),L.postMessage([]),L.close(),_()),{dataView:U,elementType:B,encoderId:k,port:L}})});f!==void 0&&g.then(({encoderId:b})=>l=m(b,f))}c.start(100)},stop:y}},tc=()=>typeof window>"u"?null:window,jr=(t,e)=>{if(e>=t.byteLength)return null;const n=t.getUint8(e);if(n>127)return 1;if(n>63)return 2;if(n>31)return 3;if(n>15)return 4;if(n>7)return 5;if(n>3)return 6;if(n>1)return 7;if(n>0)return 8;const r=jr(t,e+1);return r===null?null:r+8},nc=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},qr=[],Qt=tc(),rc=Ws(Qt),$r=Rs(rc),sc=Ja($r,xs,Ds,Tt),Jt=qs(jr),oc=Fs(Jt),ic=js(Jt),ac=Ps(oc,ic),cc=ec($r,ac,Jt),lc=Is(Qt),uc=Us(Qt),dc=Bs(Vs(Tt),Tt,sc,cc,qr,Ls(lc,nc),uc),hc=async t=>{qr.push(await Os(t))},fc=Zn({characterize:({call:t})=>()=>t("characterize"),encode:({call:t})=>(e,n)=>t("encode",{recordingId:e,timeslice:n}),record:({call:t})=>async(e,n,r)=>{await t("record",{recordingId:e,sampleRate:n,typedArrays:r},r.map(({buffer:s})=>s))}}),pc=t=>{const e=new Worker(t);return fc(e)},mc=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,s=536870912,a=2*s,o=function(e,t){return function(r){var o=t.get(r),i=void 0===o?r.size:o<a?o+1:0;if(!r.has(i))return e(r,i);if(r.size<s){for(;r.has(i);)i=Math.floor(Math.random()*a);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,l=r(i),c=o(l,i),u=t(c);e.addUniqueNumber=u,e.generateUniqueNumber=c}(t)}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,s=(e,t)=>Object.assign(new Error(e),{status:t}),a=t=>s('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),o=(t,r)=>async o=>{let{data:{id:i,method:l,params:c}}=o;const u=r[l];try{if(void 0===u)throw(e=>s('The requested method called "'.concat(e,'" is not supported.'),n))(l);const r=void 0===c?u():u(c);if(void 0===r)throw(t=>s('The handler of the method called "'.concat(t,'" returned no required result.'),e))(l);const o=r instanceof Promise?await r:r;if(null===i){if(void 0!==o.result)throw a(l)}else{if(void 0===o.result)throw a(l);const{result:e,transferables:r=[]}=o;t.postMessage({id:i,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:i})}};var i=r(455);const l=new Map,c=(e,r,n)=>({...r,connect:t=>{let{port:n}=t;n.start();const s=e(n,r),a=(0,i.generateUniqueNumber)(l);return l.set(a,(()=>{s(),n.close(),l.delete(a)})),{result:a}},disconnect:e=>{let{portId:r}=e;const n=l.get(r);if(void 0===n)throw(e=>s('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(r);return n(),{result:null}},isSupported:async()=>{if(await new Promise((e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=t=>{let{data:r}=t;return e(null!==r)},n.postMessage(t,[t])}))){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),u=function(e,t){const r=c(u,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0),n=o(e,r);return e.addEventListener("message",n),()=>e.removeEventListener("message",n)},d=e=>e.reduce(((e,t)=>e+t.length),0),h=(e,t)=>{const r=[];let n=0;e:for(;n<t;){const t=e.length;for(let s=0;s<t;s+=1){const t=e[s];void 0===r[s]&&(r[s]=[]);const a=t.shift();if(void 0===a)break e;r[s].push(a),0===s&&(n+=a.length)}}if(n>t){const s=n-t;r.forEach(((t,r)=>{const n=t.pop(),a=n.length-s;t.push(n.subarray(0,a)),e[r].unshift(n.subarray(a))}))}return r},f=new Map,m=(e=>(t,r,n)=>{const s=e.get(t);if(void 0===s){const s={channelDataArrays:n.map((e=>[e])),isComplete:!0,sampleRate:r};return e.set(t,s),s}return s.channelDataArrays.forEach(((e,t)=>e.push(n[t]))),s})(f),p=((e,t)=>(r,n,s,a)=>{const o=s>>3,i="subsequent"===n?0:44,l=r.length,c=e(r[0]),u=new ArrayBuffer(c*l*o+i),d=new DataView(u);return"subsequent"!==n&&t(d,s,l,"complete"===n?c:Number.POSITIVE_INFINITY,a),r.forEach(((e,t)=>{let r=i+t*o;e.forEach((e=>{const t=e.length;for(let n=0;n<t;n+=1){const t=e[n];d.setInt16(r,t<0?32768*Math.max(-1,t):32767*Math.min(1,t),!0),r+=l*o}}))})),[u]})(d,((e,t,r,n,s)=>{const a=t>>3,o=Math.min(n*r*a,4294967251);e.setUint32(0,1380533830),e.setUint32(4,o+36,!0),e.setUint32(8,1463899717),e.setUint32(12,1718449184),e.setUint32(16,16,!0),e.setUint16(20,1,!0),e.setUint16(22,r,!0),e.setUint32(24,s,!0),e.setUint32(28,s*r*a,!0),e.setUint16(32,r*a,!0),e.setUint16(34,t,!0),e.setUint32(36,1684108385),e.setUint32(40,o,!0)})),v=new Map;u(self,{characterize:()=>({result:/^audio\\/wav$/}),encode:e=>{let{recordingId:t,timeslice:r}=e;const n=v.get(t);void 0!==n&&(v.delete(t),n.reject(new Error("Another request was made to initiate an encoding.")));const s=f.get(t);if(null!==r){if(void 0===s||d(s.channelDataArrays[0])*(1e3/s.sampleRate)<r)return new Promise(((e,n)=>{v.set(t,{reject:n,resolve:e,timeslice:r})}));const e=h(s.channelDataArrays,Math.ceil(r*(s.sampleRate/1e3))),n=p(e,s.isComplete?"initial":"subsequent",16,s.sampleRate);return s.isComplete=!1,{result:n,transferables:n}}if(void 0!==s){const e=p(s.channelDataArrays,s.isComplete?"complete":"subsequent",16,s.sampleRate);return f.delete(t),{result:e,transferables:e}}return{result:[],transferables:[]}},record:e=>{let{recordingId:t,sampleRate:r,typedArrays:n}=e;const s=m(t,r,n),a=v.get(t);if(void 0!==a&&d(s.channelDataArrays[0])*(1e3/r)>=a.timeslice){const e=h(s.channelDataArrays,Math.ceil(a.timeslice*(r/1e3))),n=p(e,s.isComplete?"initial":"subsequent",16,r);s.isComplete=!1,v.delete(t),a.resolve({result:n,transferables:n})}return{result:null}}})})()})();`,gc=new Blob([mc],{type:"application/javascript; charset=utf-8"}),Gr=URL.createObjectURL(gc),vc=pc(Gr),yc=vc.connect;URL.revokeObjectURL(Gr);function bc(t){let e;return{c(){e=Y("button"),X(e,"class","loading w-40 h-40 bg-cover bg-no-repeat transition-all duration-300 ease-in-out rounded-full border-4 border-[#DF3A5C] svelte-19yqj34"),e.disabled=!0},m(n,r){ge(n,e,r)},p:fe,d(n){n&&ue(e)}}}function wc(t){let e,n,r;return{c(){e=Y("button"),X(e,"class","w-40 h-40 bg-cover bg-no-repeat transition-all duration-300 ease-in-out rounded-full border-4 border-[#DF3A5C]"),wt(e,"background-image","url("+At+")")},m(s,o){ge(s,e,o),n||(r=Wn(e,"click",t[5]),n=!0)},p:fe,d(s){s&&ue(e),n=!1,r()}}}function _c(t){let e,n,r,s;return{c(){e=Y("button"),X(e,"class",n="w-40 h-40 bg-cover bg-no-repeat transition-all duration-300 ease-in-out rounded-full border-4 border-[#DF3A5C] "+(t[2]?"recording":"hover:scale-110")+" svelte-19yqj34"),wt(e,"background-image","url("+(t[2]?At:ln)+")")},m(o,i){ge(o,e,i),r||(s=Wn(e,"click",t[6]),r=!0)},p(o,i){i&4&&n!==(n="w-40 h-40 bg-cover bg-no-repeat transition-all duration-300 ease-in-out rounded-full border-4 border-[#DF3A5C] "+(o[2]?"recording":"hover:scale-110")+" svelte-19yqj34")&&X(e,"class",n),i&4&&wt(e,"background-image","url("+(o[2]?At:ln)+")")},d(o){o&&ue(e),r=!1,s()}}}function Ec(t){let e;function n(o,i){return o[1]?o[0]?wc:bc:_c}let r=n(t),s=r(t);return{c(){s.c(),e=Jr()},m(o,i){s.m(o,i),ge(o,e,i)},p(o,[i]){r===(r=n(o))&&s?s.p(o,i):(s.d(1),s=r(o),s&&(s.c(),s.m(e.parentNode,e)))},i:fe,o:fe,d(o){o&&ue(e),s.d(o)}}}const Cc=1,Ac=3e3;function Tc(t,e,n){ns(async()=>{await hc(await yc())});const r=rs();let{isLoading:s=!1}=e,{isPlaying:o=!1}=e,i=null,a=null,c=[],l=!1,u=null;async function d(){n(2,l=!0),c=[],r("start"),i=await navigator.mediaDevices.getUserMedia({audio:!0}),a=new dc(i,{mimeType:"audio/wav"}),a.addEventListener("dataavailable",g=>{c.push(g.data)}),a.addEventListener("stop",()=>{i==null||i.getTracks().forEach(g=>g.stop())});const h=new AudioContext,v=h.createMediaStreamSource(i),p=h.createAnalyser();v.connect(p);const C=p.frequencyBinCount,w=new Uint8Array(C);function A(){p.getByteFrequencyData(w),w.reduce((b,E)=>b+E,0)/C<Cc?u||(u=setTimeout(()=>{m()},Ac)):(clearTimeout(u),u=null),l&&requestAnimationFrame(A)}a.start(500),requestAnimationFrame(A)}async function m(){n(2,l=!1),a==null||a.stop(),r("stopRecording",c)}async function y(){n(0,o=!1),r("stopPlayback")}const f=()=>{l?m():d()};return t.$$set=h=>{"isLoading"in h&&n(1,s=h.isLoading),"isPlaying"in h&&n(0,o=h.isPlaying)},[o,s,l,d,m,y,f]}class Mc extends zn{constructor(e){super(),Gn(this,e,Tc,Ec,Bn,{isLoading:1,isPlaying:0})}}function Ln(t){let e,n,r,s,o;return{c(){e=Y("div"),n=Y("span"),n.textContent="You said:",r=ae(),s=Y("span"),o=rt(t[0]),X(n,"class","italic dark:font-semibold mb-2"),X(s,"class",""),X(e,"class","text-[#050A30] dark:text-[#f8f9fa] userSpeech text-base md:text-xl xl:text-2xl mt-10")},m(i,a){ge(i,e,a),G(e,n),G(e,r),G(e,s),G(s,o)},p(i,a){a&1&&Un(o,i[0])},d(i){i&&ue(e)}}}function In(t){let e,n,r,s,o;return{c(){e=Y("div"),n=Y("span"),n.textContent="Karen said:",r=ae(),s=Y("span"),o=rt(t[1]),X(n,"class","italic dark:font-semibold mb-2"),X(s,"class",""),X(e,"class","text-[#050A30] dark:text-[#f8f9fa] karenSpeech text-base md:text-xl xl:text-2xl mt-4")},m(i,a){ge(i,e,a),G(e,n),G(e,r),G(e,s),G(s,o)},p(i,a){a&2&&Un(o,i[1])},d(i){i&&ue(e)}}}function kc(t){let e,n,r,s,o,i,a,c,l,u,d,m,y,f,h,v,p;function C(b){t[7](b)}function w(b){t[8](b)}let A={};t[2]!==void 0&&(A.isLoading=t[2]),t[3]!==void 0&&(A.isPlaying=t[3]),u=new Mc({props:A}),He.push(()=>sn(u,"isLoading",C)),He.push(()=>sn(u,"isPlaying",w)),u.$on("start",t[5]),u.$on("stopRecording",t[4]),u.$on("stopPlayback",t[5]);let g=t[0]&&Ln(t),_=t[1]&&In(t);return{c(){e=Y("main"),n=Y("div"),n.innerHTML='<button class="w-8 text-[#050A30] dark:text-[#f8f9fa]"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="m9.25 22l-.4-3.2q-.325-.125-.612-.3t-.563-.375L4.7 19.375l-2.75-4.75l2.575-1.95Q4.5 12.5 4.5 12.338v-.675q0-.163.025-.338L1.95 9.375l2.75-4.75l2.975 1.25q.275-.2.575-.375t.6-.3l.4-3.2h5.5l.4 3.2q.325.125.613.3t.562.375l2.975-1.25l2.75 4.75l-2.575 1.95q.025.175.025.338v.674q0 .163-.05.338l2.575 1.95l-2.75 4.75l-2.95-1.25q-.275.2-.575.375t-.6.3l-.4 3.2zM11 20h1.975l.35-2.65q.775-.2 1.438-.587t1.212-.938l2.475 1.025l.975-1.7l-2.15-1.625q.125-.35.175-.737T17.5 12q0-.4-.05-.787t-.175-.738l2.15-1.625l-.975-1.7l-2.475 1.05q-.55-.575-1.212-.962t-1.438-.588L13 4h-1.975l-.35 2.65q-.775.2-1.437.588t-1.213.937L5.55 7.15l-.975 1.7l2.15 1.6q-.125.375-.175.75t-.05.8q0 .4.05.775t.175.75l-2.15 1.625l.975 1.7l2.475-1.05q.55.575 1.213.963t1.437.587zm1.05-4.5q1.45 0 2.475-1.025T15.55 12q0-1.45-1.025-2.475T12.05 8.5q-1.475 0-2.488 1.025T8.55 12q0 1.45 1.013 2.475T12.05 15.5M12 12"></path></svg></button>',r=ae(),s=Y("div"),o=Y("h1"),o.textContent="Karen. The Voice Assistant",i=ae(),a=Y("h6"),a.textContent="Click on the microphone to start speaking",c=ae(),l=Y("div"),us(u.$$.fragment),y=ae(),g&&g.c(),f=ae(),_&&_.c(),h=ae(),v=Y("div"),X(n,"class","absolute bottom-10 xl:top-10 right-10"),X(o,"class","text-3xl md:text-5xl xl:text-6xl text-[#050A30] dark:text-[#f8f9fa] text-center"),X(a,"class","italic text-xs md:text-sm mt-2 dark:text-[#e9ecef]"),X(l,"class","recorder mt-20 md:mt-40 xl:mt-60"),X(v,"id","waveform"),X(v,"class","mt-4 w-96 h-48"),X(s,"class","container mx-auto flex flex-col items-center px-8 py-10 md:py-20 xl:py-30 h-full"),X(e,"class","main-bg dark:main-bg-dark relative w-full h-screen font-primary")},m(b,E){ge(b,e,E),G(e,n),G(e,r),G(e,s),G(s,o),G(s,i),G(s,a),G(s,c),G(s,l),qn(u,l,null),G(s,y),g&&g.m(s,null),G(s,f),_&&_.m(s,null),G(s,h),G(s,v),p=!0},p(b,[E]){const M={};!d&&E&4&&(d=!0,M.isLoading=b[2],rn(()=>d=!1)),!m&&E&8&&(m=!0,M.isPlaying=b[3],rn(()=>m=!1)),u.$set(M),b[0]?g?g.p(b,E):(g=Ln(b),g.c(),g.m(s,f)):g&&(g.d(1),g=null),b[1]?_?_.p(b,E):(_=In(b),_.c(),_.m(s,h)):_&&(_.d(1),_=null)},i(b){p||(jn(u.$$.fragment,b),p=!0)},o(b){ls(u.$$.fragment,b),p=!1},d(b){b&&ue(e),$n(u),g&&g.d(),_&&_.d()}}}function Nc(t,e,n){let r=null,s=null,o=!1,i=!1,a=null;async function c(){a||n(6,a=Le.create({container:"#waveform",waveColor:"#ff758f",progressColor:"#c9184a",cursorColor:"#ffccd5",barWidth:2,barRadius:3,normalize:!0}))}async function l(f){n(2,o=!0);const h=new Blob(f.detail,{type:"audio/wav"}),v=new FormData;v.append("audio",h),fetch("/speech-to-text",{method:"POST",body:v,headers:{"Cache-Control":"no-cache"}}).then(async p=>{const C=await p.json();n(2,o=!1),n(0,r=C.text),u(C.text)}).catch(p=>{console.error("Error sending audio to API:",p)})}async function u(f){n(2,o=!0),fetch("/send-to-chatgpt",{method:"POST",body:JSON.stringify({text:f}),headers:{"Content-Type":"application/json","Cache-Control":"no-cache"}}).then(async h=>{const v=h.headers.get("Content-Type"),p=h.headers.get("chat_response");if(v!=null&&v.includes("audio/mpeg")){const C=await h.arrayBuffer(),w=new Blob([C],{type:"audio/mpeg"}),A=URL.createObjectURL(w);await c(),a==null||a.load(A),a==null||a.play(),n(3,i=!0)}p&&n(1,s=p),n(2,o=!1)}).catch(h=>{console.error("Error sending audio to API:",h)})}function d(){n(3,i=!1),a==null||a.playPause(),a==null||a.destroy(),n(6,a=null),n(0,r=null),n(1,s=null)}function m(f){o=f,n(2,o)}function y(f){i=f,n(3,i),n(6,a)}return t.$$.update=()=>{t.$$.dirty&64&&(a==null||a.on("finish",()=>{n(3,i=!1),a==null||a.destroy(),n(6,a=null)})),t.$$.dirty&64&&(a==null||a.on("init",()=>{a==null||a.play()}))},[r,s,o,i,l,d,a,m,y]}class Sc extends zn{constructor(e){super(),Gn(this,e,Nc,kc,Bn,{})}}new Sc({target:document.getElementById("app")});
